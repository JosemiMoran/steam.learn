var OY=(Y)=>{const J=Y.split("/");if(J[0]==="")J.shift();return J},BY=(Y)=>{const J=[];for(let K=0;;){let Q=!1;if(Y=Y.replace(/\{[^}]+\}/g,(X)=>{const H=`@\\${K}`;return J[K]=[H,X],K++,Q=!0,H}),!Q)break}const Z=Y.split("/");if(Z[0]==="")Z.shift();for(let K=J.length-1;K>=0;K--){const[Q]=J[K];for(let X=Z.length-1;X>=0;X--)if(Z[X].indexOf(Q)!==-1){Z[X]=Z[X].replace(Q,J[K][1]);break}}return Z},p1={},C0=(Y)=>{if(Y==="*")return"*";const J=Y.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(J){if(!p1[Y])if(J[2])p1[Y]=[Y,J[1],new RegExp("^"+J[2]+"$")];else p1[Y]=[Y,J[1],!0];return p1[Y]}return null},F0=(Y)=>{const J=Y.url.match(/^https?:\/\/[^/]+(\/[^?]*)/);return J?J[1]:""},CY=(Y)=>{const J=Y.indexOf("?",8);return J===-1?"":"?"+Y.slice(J+1)},FY=(Y)=>{const J=F0(Y);return J.length>1&&J[J.length-1]==="/"?J.slice(0,-1):J},M1=(...Y)=>{let J="",Z=!1;for(let K of Y){if(J[J.length-1]==="/")J=J.slice(0,-1),Z=!0;if(K[0]!=="/")K=`/${K}`;if(K==="/"&&Z)J=`${J}/`;else if(K!=="/")J=`${J}${K}`;if(K==="/"&&J==="")J="/"}return J},l1=(Y)=>{const J=Y.match(/^(.+|)(\/\:[^\/]+)\?$/);if(!J)return null;const Z=J[1],K=Z+J[2];return[Z===""?"/":Z.replace(/\/$/,""),K]},B0=(Y)=>{if(!/[%+]/.test(Y))return Y;if(Y.indexOf("+")!==-1)Y=Y.replace(/\+/g," ");return/%/.test(Y)?q1(Y):Y},wY=(Y,J,Z)=>{let K;if(!Z&&J&&!/[%+]/.test(J)){let H=Y.indexOf(`?${J}`,8);if(H===-1)H=Y.indexOf(`&${J}`,8);while(H!==-1){const z=Y.charCodeAt(H+J.length+1);if(z===61){const V=H+J.length+2,W=Y.indexOf("&",V);return B0(Y.slice(V,W===-1?void 0:W))}else if(z==38||isNaN(z))return"";H=Y.indexOf(`&${J}`,H+1)}if(K=/[%+]/.test(Y),!K)return}const Q={};K??(K=/[%+]/.test(Y));let X=Y.indexOf("?",8);while(X!==-1){const H=Y.indexOf("&",X+1);let z=Y.indexOf("=",X);if(z>H&&H!==-1)z=-1;let V=Y.slice(X+1,z===-1?H===-1?void 0:H:z);if(K)V=B0(V);if(X=H,V==="")continue;let W;if(z===-1)W="";else if(W=Y.slice(z+1,H===-1?void 0:H),K)W=B0(W);if(Z){if(!(Q[V]&&Array.isArray(Q[V])))Q[V]=[];Q[V].push(W)}else Q[V]??(Q[V]=W)}return J?Q[J]:Q},IY=wY,RY=(Y,J)=>{return wY(Y,J,!0)},q1=decodeURIComponent;var KZ=/^[\w!#$%&'*.^`|~+-]+$/,QZ=/^[ !#-:<-[\]-~]*$/,AY=(Y,J)=>{return Y.trim().split(";").reduce((K,Q)=>{Q=Q.trim();const X=Q.indexOf("=");if(X===-1)return K;const H=Q.substring(0,X).trim();if(J&&J!==H||!KZ.test(H))return K;let z=Q.substring(X+1).trim();if(z.startsWith('"')&&z.endsWith('"'))z=z.slice(1,-1);if(QZ.test(z))K[H]=q1(z);return K},{})};var XZ=(Y,J,Z={})=>{let K=`${Y}=${J}`;if(Z&&typeof Z.maxAge==="number"&&Z.maxAge>=0)K+=`; Max-Age=${Math.floor(Z.maxAge)}`;if(Z.domain)K+=`; Domain=${Z.domain}`;if(Z.path)K+=`; Path=${Z.path}`;if(Z.expires)K+=`; Expires=${Z.expires.toUTCString()}`;if(Z.httpOnly)K+="; HttpOnly";if(Z.secure)K+="; Secure";if(Z.sameSite)K+=`; SameSite=${Z.sameSite}`;if(Z.partitioned)K+="; Partitioned";return K},xY=(Y,J,Z={})=>{return J=encodeURIComponent(J),XZ(Y,J,Z)};var w0=(Y,J)=>{if(!Y.callbacks?.length)return Promise.resolve(Y);const Z=Y.callbacks;if(J)J[0]+=Y;else J=[Y];return Promise.all(Z.map((K)=>K({buffer:J}))).then((K)=>Promise.all(K.map((Q)=>w0(Q,J))).then(()=>J[0]))};var GY=class{constructor(Y){this.writable=Y,this.writer=Y.getWriter(),this.encoder=new TextEncoder}async write(Y){try{if(typeof Y==="string")Y=this.encoder.encode(Y);await this.writer.write(Y)}catch(J){}return this}async writeln(Y){return await this.write(Y+"\n"),this}sleep(Y){return new Promise((J)=>setTimeout(J,Y))}async close(){try{await this.writer.close()}catch(Y){}}async pipe(Y){this.writer.releaseLock(),await Y.pipeTo(this.writable,{preventClose:!0}),this.writer=this.writable.getWriter()}};var TY=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},E=(Y,J,Z)=>{return TY(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},E1=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},_=(Y,J,Z,K)=>{return TY(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},SY="text/plain; charset=UTF-8",f1,Q1,f,P,a,X1,O1=class{constructor(Y,J){if(this.env={},this._var={},this.finalized=!1,this.error=void 0,E1(this,f1,200),E1(this,Q1,void 0),E1(this,f,void 0),E1(this,P,void 0),E1(this,a,void 0),E1(this,X1,!0),this.renderer=(Z)=>this.html(Z),this.notFoundHandler=()=>new Response,this.render=(...Z)=>this.renderer(...Z),this.setRenderer=(Z)=>{this.renderer=Z},this.header=(Z,K,Q)=>{if(K===void 0){if(E(this,f))E(this,f).delete(Z);else if(E(this,P))delete E(this,P)[Z.toLocaleLowerCase()];if(this.finalized)this.res.headers.delete(Z);return}if(Q?.append){if(!E(this,f))_(this,X1,!1),_(this,f,new Headers(E(this,P))),_(this,P,{});E(this,f).append(Z,K)}else if(E(this,f))E(this,f).set(Z,K);else E(this,P)??_(this,P,{}),E(this,P)[Z.toLowerCase()]=K;if(this.finalized)if(Q?.append)this.res.headers.append(Z,K);else this.res.headers.set(Z,K)},this.status=(Z)=>{_(this,X1,!1),_(this,f1,Z)},this.set=(Z,K)=>{this._var??(this._var={}),this._var[Z]=K},this.get=(Z)=>{return this._var?this._var[Z]:void 0},this.newResponse=(Z,K,Q)=>{if(E(this,X1)&&!Q&&!K&&E(this,f1)===200)return new Response(Z,{headers:E(this,P)});if(K&&typeof K!=="number")this.res=new Response(Z,K);const X=typeof K==="number"?K:K?K.status:E(this,f1);E(this,P)??_(this,P,{}),E(this,f)??_(this,f,new Headers);for(let[H,z]of Object.entries(E(this,P)))E(this,f).set(H,z);if(E(this,a)){E(this,a).headers.forEach((H,z)=>{E(this,f)?.set(z,H)});for(let[H,z]of Object.entries(E(this,P)))E(this,f).set(H,z)}Q??(Q={});for(let[H,z]of Object.entries(Q))if(typeof z==="string")E(this,f).set(H,z);else{E(this,f).delete(H);for(let V of z)E(this,f).append(H,V)}return new Response(Z,{status:X,headers:E(this,f)})},this.body=(Z,K,Q)=>{return typeof K==="number"?this.newResponse(Z,K,Q):this.newResponse(Z,K)},this.text=(Z,K,Q)=>{if(!E(this,P)){if(E(this,X1)&&!Q&&!K)return new Response(Z);_(this,P,{})}return E(this,P)["content-type"]=SY,typeof K==="number"?this.newResponse(Z,K,Q):this.newResponse(Z,K)},this.json=(Z,K,Q)=>{const X=JSON.stringify(Z);return E(this,P)??_(this,P,{}),E(this,P)["content-type"]="application/json; charset=UTF-8",typeof K==="number"?this.newResponse(X,K,Q):this.newResponse(X,K)},this.jsonT=(Z,K,Q)=>{return this.json(Z,K,Q)},this.html=(Z,K,Q)=>{if(E(this,P)??_(this,P,{}),E(this,P)["content-type"]="text/html; charset=UTF-8",typeof Z==="object"){if(!(Z instanceof Promise))Z=Z.toString();if(Z instanceof Promise)return Z.then((X)=>w0(X)).then((X)=>{return typeof K==="number"?this.newResponse(X,K,Q):this.newResponse(X,K)})}return typeof K==="number"?this.newResponse(Z,K,Q):this.newResponse(Z,K)},this.redirect=(Z,K=302)=>{return E(this,f)??_(this,f,new Headers),E(this,f).set("Location",Z),this.newResponse(null,K)},this.streamText=(Z,K,Q)=>{return Q??(Q={}),this.header("content-type",SY),this.header("x-content-type-options","nosniff"),this.header("transfer-encoding","chunked"),this.stream(Z,K,Q)},this.stream=(Z,K,Q)=>{const{readable:X,writable:H}=new TransformStream,z=new GY(H);return Z(z).finally(()=>z.close()),typeof K==="number"?this.newResponse(X,K,Q):this.newResponse(X,K)},this.cookie=(Z,K,Q)=>{const X=xY(Z,K,Q);this.header("set-cookie",X,{append:!0})},this.notFound=()=>{return this.notFoundHandler(this)},this.req=Y,J){if(_(this,Q1,J.executionCtx),this.env=J.env,J.notFoundHandler)this.notFoundHandler=J.notFoundHandler}}get event(){if(E(this,Q1)&&"respondWith"in E(this,Q1))return E(this,Q1);else throw Error("This context has no FetchEvent")}get executionCtx(){if(E(this,Q1))return E(this,Q1);else throw Error("This context has no ExecutionContext")}get res(){return _(this,X1,!1),E(this,a)||_(this,a,new Response("404 Not Found",{status:404}))}set res(Y){if(_(this,X1,!1),E(this,a)&&Y)E(this,a).headers.delete("content-type"),E(this,a).headers.forEach((J,Z)=>{Y.headers.set(Z,J)});_(this,a,Y),this.finalized=!0}get var(){return{...this._var}}get runtime(){const Y=globalThis;if(Y?.Deno!==void 0)return"deno";if(Y?.Bun!==void 0)return"bun";if(typeof Y?.WebSocketPair==="function")return"workerd";if(typeof Y?.EdgeRuntime==="string")return"edge-light";if(Y?.fastly!==void 0)return"fastly";if(Y?.__lagon__!==void 0)return"lagon";if(Y?.process?.release?.name==="node")return"node";return"other"}};f1=new WeakMap;Q1=new WeakMap;f=new WeakMap;P=new WeakMap;a=new WeakMap;X1=new WeakMap;var I0=(Y,J,Z)=>{return(K,Q)=>{let X=-1;return H(0);async function H(z){if(z<=X)throw new Error("next() called multiple times");X=z;let V,W=!1,U;if(Y[z]){if(U=Y[z][0][0],K instanceof O1)K.req.routeIndex=z}else U=z===Y.length&&Q||void 0;if(!U){if(K instanceof O1&&K.finalized===!1&&Z)V=await Z(K)}else try{V=await U(K,()=>{return H(z+1)})}catch(N){if(N instanceof Error&&K instanceof O1&&J)K.error=N,V=await J(N,K),W=!0;else throw N}if(V&&(K.finalized===!1||W))K.res=V;return K}}};var $Y=class extends Error{constructor(Y=500,J){super(J?.message);this.res=J?.res,this.status=Y}getResponse(){if(this.res)return this.res;return new Response(this.message,{status:this.status})}};var HZ=(Y)=>{return Array.isArray(Y)},PY=async(Y,J={all:!1})=>{let Z={};const K=Y.headers.get("Content-Type");if(K&&(K.startsWith("multipart/form-data")||K.startsWith("application/x-www-form-urlencoded"))){const Q=await Y.formData();if(Q){const X={};Q.forEach((H,z)=>{if(!(J.all||z.slice(-2)==="[]")){X[z]=H;return}if(X[z]&&HZ(X[z])){X[z].push(H);return}if(X[z]){X[z]=[X[z],H];return}X[z]=H}),Z=X}}return Z};var kY=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},l=(Y,J,Z)=>{return kY(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},jY=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},fY=(Y,J,Z,K)=>{return kY(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},k1,p,yY=class{constructor(Y,J="/",Z=[[]]){jY(this,k1,void 0),jY(this,p,void 0),this.routeIndex=0,this.bodyCache={},this.cachedBody=(K)=>{const{bodyCache:Q,raw:X}=this,H=Q[K];if(H)return H;if(Q.arrayBuffer)return(async()=>{return await new Response(Q.arrayBuffer)[K]()})();return Q[K]=X[K]()},this.raw=Y,this.path=J,fY(this,p,Z),fY(this,k1,{})}param(Y){if(Y){const J=l(this,p)[1]?l(this,p)[1][l(this,p)[0][this.routeIndex][1][Y]]:l(this,p)[0][this.routeIndex][1][Y];return J?/\%/.test(J)?q1(J):J:void 0}else{const J={},Z=Object.keys(l(this,p)[0][this.routeIndex][1]);for(let K=0,Q=Z.length;K<Q;K++){const X=Z[K],H=l(this,p)[1]?l(this,p)[1][l(this,p)[0][this.routeIndex][1][X]]:l(this,p)[0][this.routeIndex][1][X];if(H&&typeof H==="string")J[X]=/\%/.test(H)?q1(H):H}return J}}query(Y){return IY(this.url,Y)}queries(Y){return RY(this.url,Y)}header(Y){if(Y)return this.raw.headers.get(Y.toLowerCase())??void 0;const J={};return this.raw.headers.forEach((Z,K)=>{J[K]=Z}),J}cookie(Y){const J=this.raw.headers.get("Cookie");if(!J)return;const Z=AY(J);if(Y)return Z[Y];else return Z}async parseBody(Y){if(this.bodyCache.parsedBody)return this.bodyCache.parsedBody;const J=await PY(this,Y);return this.bodyCache.parsedBody=J,J}json(){return this.cachedBody("json")}text(){return this.cachedBody("text")}arrayBuffer(){return this.cachedBody("arrayBuffer")}blob(){return this.cachedBody("blob")}formData(){return this.cachedBody("formData")}addValidatedData(Y,J){l(this,k1)[Y]=J}valid(Y){return l(this,k1)[Y]}get url(){return this.raw.url}get method(){return this.raw.method}get matchedRoutes(){return l(this,p)[0].map(([[,Y]])=>Y)}get routePath(){return l(this,p)[0].map(([[,Y]])=>Y)[this.routeIndex].path}get headers(){return this.raw.headers}get body(){return this.raw.body}get bodyUsed(){return this.raw.bodyUsed}get integrity(){return this.raw.integrity}get keepalive(){return this.raw.keepalive}get referrer(){return this.raw.referrer}get signal(){return this.raw.signal}};k1=new WeakMap;p=new WeakMap;var j="ALL",vY="all",n1=["get","post","put","delete","options","patch"],o1="Can not add a route since the matcher is already built.",i1=class extends Error{};var VZ=function(){return class{}},hY=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},s1=(Y,J,Z)=>{return hY(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},zZ=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},R0=(Y,J,Z,K)=>{return hY(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},WZ=(Y)=>{return Y.text("404 Not Found",404)},gY=(Y,J)=>{if(Y instanceof $Y)return Y.getResponse();console.error(Y);const Z="Internal Server Error";return J.text(Z,500)},J1,_Y=class extends VZ(){constructor(Y={}){super();this._basePath="/",zZ(this,J1,"/"),this.routes=[],this.notFoundHandler=WZ,this.errorHandler=gY,this.onError=(K)=>{return this.errorHandler=K,this},this.notFound=(K)=>{return this.notFoundHandler=K,this},this.head=()=>{return console.warn("`app.head()` is no longer used. `app.get()` implicitly handles the HEAD method."),this},this.handleEvent=(K)=>{return this.dispatch(K.request,K,void 0,K.request.method)},this.fetch=(K,Q,X)=>{return this.dispatch(K,X,Q,K.method)},this.request=(K,Q,X,H)=>{if(K instanceof Request){if(Q!==void 0)K=new Request(K,Q);return this.fetch(K,X,H)}K=K.toString();const z=/^https?:\/\//.test(K)?K:`http://localhost${M1("/",K)}`,V=new Request(z,Q);return this.fetch(V,X,H)},this.fire=()=>{addEventListener("fetch",(K)=>{K.respondWith(this.dispatch(K.request,K,void 0,K.request.method))})},[...n1,vY].map((K)=>{this[K]=(Q,...X)=>{if(typeof Q==="string")R0(this,J1,Q);else this.addRoute(K,s1(this,J1),Q);return X.map((H)=>{if(typeof H!=="string")this.addRoute(K,s1(this,J1),H)}),this}}),this.on=(K,Q,...X)=>{if(!K)return this;R0(this,J1,Q);for(let H of[K].flat())X.map((z)=>{this.addRoute(H.toUpperCase(),s1(this,J1),z)});return this},this.use=(K,...Q)=>{if(typeof K==="string")R0(this,J1,K);else Q.unshift(K);return Q.map((X)=>{this.addRoute(j,s1(this,J1),X)}),this};const Z=Y.strict??!0;delete Y.strict,Object.assign(this,Y),this.getPath=Z?Y.getPath??F0:FY}clone(){const Y=new _Y({router:this.router,getPath:this.getPath});return Y.routes=this.routes,Y}route(Y,J){const Z=this.basePath(Y);if(!J)return Z;return J.routes.map((K)=>{const Q=J.errorHandler===gY?K.handler:async(X,H)=>(await I0([],J.errorHandler)(X,()=>K.handler(X,H))).res;Z.addRoute(K.method,K.path,Q)}),this}basePath(Y){const J=this.clone();return J._basePath=M1(this._basePath,Y),J}showRoutes(){this.routes.map((J)=>{console.log(`\x1B[32m${J.method}\x1B[0m ${" ".repeat(8-J.method.length)} ${J.path}`)})}mount(Y,J,Z){const K=M1(this._basePath,Y),Q=K==="/"?0:K.length,X=async(H,z)=>{let V=void 0;try{V=H.executionCtx}catch{}const W=Z?Z(H):[H.env,V],U=Array.isArray(W)?W:[W],N=CY(H.req.url),M=await J(new Request(new URL((H.req.path.slice(Q)||"/")+N,H.req.url),H.req.raw),...U);if(M)return M;await z()};return this.addRoute(j,M1(Y,"*"),X),this}get routerName(){return this.matchRoute("GET","/"),this.router.name}addRoute(Y,J,Z){Y=Y.toUpperCase(),J=M1(this._basePath,J);const K={path:J,method:Y,handler:Z};this.router.add(Y,J,[Z,K]),this.routes.push(K)}matchRoute(Y,J){return this.router.match(Y,J)}handleError(Y,J){if(Y instanceof Error)return this.errorHandler(Y,J);throw Y}dispatch(Y,J,Z,K){if(K==="HEAD")return(async()=>new Response(null,await this.dispatch(Y,J,Z,"GET")))();const Q=this.getPath(Y,{env:Z}),X=this.matchRoute(K,Q),H=new O1(new yY(Y,Q,X),{env:Z,executionCtx:J,notFoundHandler:this.notFoundHandler});if(X[0].length===1){let V;try{if(V=X[0][0][0][0](H,async()=>{}),!V)return this.notFoundHandler(H)}catch(W){return this.handleError(W,H)}if(V instanceof Response)return V;return(async()=>{let W;try{if(W=await V,!W)return this.notFoundHandler(H)}catch(U){return this.handleError(U,H)}return W})()}const z=I0(X[0],this.errorHandler,this.notFoundHandler);return(async()=>{try{const V=await z(H);if(!V.finalized)throw new Error("Context is not finalized. You may forget returning Response object or `await next()`");return V.res}catch(V){return this.handleError(V,H)}})()}},uY=_Y;J1=new WeakMap;var NZ=function(Y,J){if(Y.length===1)return J.length===1?Y<J?-1:1:-1;if(J.length===1)return 1;if(Y===y1||Y===v1)return 1;else if(J===y1||J===v1)return-1;if(Y===r1)return 1;else if(J===r1)return-1;return Y.length===J.length?Y<J?-1:1:J.length-Y.length},r1="[^/]+",y1=".*",v1="(?:|/.*)",B1=Symbol(),t1=class{constructor(){this.children={}}insert(Y,J,Z,K,Q){if(Y.length===0){if(this.index!==void 0)throw B1;if(Q)return;this.index=J;return}const[X,...H]=Y,z=X==="*"?H.length===0?["","",y1]:["","",r1]:X==="/*"?["","",v1]:X.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);let V;if(z){const W=z[1];let U=z[2]||r1;if(W&&z[2]){if(U=U.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(U))throw B1}if(V=this.children[U],!V){if(Object.keys(this.children).some((N)=>N!==y1&&N!==v1))throw B1;if(Q)return;if(V=this.children[U]=new t1,W!=="")V.varIndex=K.varIndex++}if(!Q&&W!=="")Z.push([W,V.varIndex])}else if(V=this.children[X],!V){if(Object.keys(this.children).some((W)=>W.length>1&&W!==y1&&W!==v1))throw B1;if(Q)return;V=this.children[X]=new t1}V.insert(H,J,Z,K,Q)}buildRegExpStr(){const J=Object.keys(this.children).sort(NZ).map((Z)=>{const K=this.children[Z];return(typeof K.varIndex==="number"?`(${Z})@${K.varIndex}`:Z)+K.buildRegExpStr()});if(typeof this.index==="number")J.unshift(`#${this.index}`);if(J.length===0)return"";if(J.length===1)return J[0];return"(?:"+J.join("|")+")"}};var mY=class{constructor(){this.context={varIndex:0},this.root=new t1}insert(Y,J,Z){const K=[],Q=[];for(let H=0;;){let z=!1;if(Y=Y.replace(/\{[^}]+\}/g,(V)=>{const W=`@\\${H}`;return Q[H]=[W,V],H++,z=!0,W}),!z)break}const X=Y.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let H=Q.length-1;H>=0;H--){const[z]=Q[H];for(let V=X.length-1;V>=0;V--)if(X[V].indexOf(z)!==-1){X[V]=X[V].replace(z,Q[H][1]);break}}return this.root.insert(X,J,K,this.context,Z),K}buildRegExp(){let Y=this.root.buildRegExpStr();if(Y==="")return[/^$/,[],[]];let J=0;const Z=[],K=[];return Y=Y.replace(/#(\d+)|@(\d+)|\.\*\$/g,(Q,X,H)=>{if(typeof X!=="undefined")return Z[++J]=Number(X),"$()";if(typeof H!=="undefined")return K[Number(H)]=++J,"";return""}),[new RegExp(`^${Y}`),Z,K]}};var dY=function(Y){return x0[Y]??(x0[Y]=new RegExp(Y==="*"?"":`^${Y.replace(/\/\*/,"(?:|/.*)")}\$`))},LZ=function(){x0={}},DZ=function(Y){const J=new mY,Z=[];if(Y.length===0)return UZ;const K=Y.map((W)=>[!/\*|\/:/.test(W[0]),...W]).sort(([W,U],[N,M])=>W?1:N?-1:U.length-M.length),Q={};for(let W=0,U=-1,N=K.length;W<N;W++){const[M,B,S]=K[W];if(M)Q[B]=[S.map(([I])=>[I,{}]),bY];else U++;let C;try{C=J.insert(B,U,M)}catch(I){throw I===B1?new i1(B):I}if(M)continue;Z[U]=S.map(([I,T])=>{const $={};T-=1;for(;T>=0;T--){const[y,v]=C[T];$[y]=v}return[I,$]})}const[X,H,z]=J.buildRegExp();for(let W=0,U=Z.length;W<U;W++)for(let N=0,M=Z[W].length;N<M;N++){const B=Z[W][N]?.[1];if(!B)continue;const S=Object.keys(B);for(let C=0,I=S.length;C<I;C++)B[S[C]]=z[B[S[C]]]}const V=[];for(let W in H)V[W]=Z[H[W]];return[X,V,Q]},C1=function(Y,J){if(!Y)return;for(let Z of Object.keys(Y).sort((K,Q)=>Q.length-K.length))if(dY(Z).test(J))return[...Y[Z]];return},A0=[j,...n1].map((Y)=>Y.toUpperCase()),bY=[],UZ=[/^$/,[],{}],x0={},G0=class{constructor(){this.name="RegExpRouter",this.middleware={[j]:{}},this.routes={[j]:{}}}add(Y,J,Z){var K;const{middleware:Q,routes:X}=this;if(!Q||!X)throw new Error(o1);if(A0.indexOf(Y)===-1)A0.push(Y);if(!Q[Y])[Q,X].forEach((V)=>{V[Y]={},Object.keys(V[j]).forEach((W)=>{V[Y][W]=[...V[j][W]]})});if(J==="/*")J="*";const H=(J.match(/\/:/g)||[]).length;if(/\*$/.test(J)){const V=dY(J);if(Y===j)Object.keys(Q).forEach((W)=>{var U;(U=Q[W])[J]||(U[J]=C1(Q[W],J)||C1(Q[j],J)||[])});else(K=Q[Y])[J]||(K[J]=C1(Q[Y],J)||C1(Q[j],J)||[]);Object.keys(Q).forEach((W)=>{if(Y===j||Y===W)Object.keys(Q[W]).forEach((U)=>{V.test(U)&&Q[W][U].push([Z,H])})}),Object.keys(X).forEach((W)=>{if(Y===j||Y===W)Object.keys(X[W]).forEach((U)=>V.test(U)&&X[W][U].push([Z,H]))});return}const z=l1(J)||[J];for(let V=0,W=z.length;V<W;V++){const U=z[V];Object.keys(X).forEach((N)=>{var M;if(Y===j||Y===N)(M=X[N])[U]||(M[U]=[...C1(Q[N],U)||C1(Q[j],U)||[]]),X[N][U].push([Z,z.length===2&&V===0?H-1:H])})}}match(Y,J){LZ();const Z=this.buildAllMatchers();return this.match=(K,Q)=>{const X=Z[K],H=X[2][Q];if(H)return H;const z=Q.match(X[0]);if(!z)return[[],bY];const V=z.indexOf("",1);return[X[1][V],z]},this.match(Y,J)}buildAllMatchers(){const Y={};return A0.forEach((J)=>{Y[J]=this.buildMatcher(J)||Y[j]}),this.middleware=this.routes=void 0,Y}buildMatcher(Y){const J=[];let Z=Y===j;if([this.middleware,this.routes].forEach((K)=>{const Q=K[Y]?Object.keys(K[Y]).map((X)=>[X,K[Y][X]]):[];if(Q.length!==0)Z||(Z=!0),J.push(...Q);else if(Y!==j)J.push(...Object.keys(K[j]).map((X)=>[X,K[j][X]]))}),!Z)return null;else return DZ(J)}};var S0=class{constructor(Y){this.name="SmartRouter",this.routers=[],this.routes=[],Object.assign(this,Y)}add(Y,J,Z){if(!this.routes)throw new Error(o1);this.routes.push([Y,J,Z])}match(Y,J){if(!this.routes)throw new Error("Fatal error");const{routers:Z,routes:K}=this,Q=Z.length;let X=0,H;for(;X<Q;X++){const z=Z[X];try{K.forEach((V)=>{z.add(...V)}),H=z.match(Y,J)}catch(V){if(V instanceof i1)continue;throw V}this.match=z.match.bind(z),this.routers=[z],this.routes=void 0;break}if(X===Q)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,H}get activeRouter(){if(this.routes||this.routers.length!==1)throw new Error("No active router has been determined yet.");return this.routers[0]}};var T0=class{constructor(Y,J,Z){if(this.order=0,this.params={},this.children=Z||{},this.methods=[],this.name="",Y&&J){const K={};K[Y]={handler:J,possibleKeys:[],score:0,name:this.name},this.methods=[K]}this.patterns=[]}insert(Y,J,Z){this.name=`${Y} ${J}`,this.order=++this.order;let K=this;const Q=BY(J),X=[],H=[];for(let W=0,U=Q.length;W<U;W++){const N=Q[W];if(Object.keys(K.children).includes(N)){H.push(...K.patterns),K=K.children[N];const B=C0(N);if(B)X.push(B[1]);continue}K.children[N]=new T0;const M=C0(N);if(M)K.patterns.push(M),H.push(...K.patterns),X.push(M[1]);H.push(...K.patterns),K=K.children[N]}if(!K.methods.length)K.methods=[];const z={},V={handler:Z,possibleKeys:X,name:this.name,score:this.order};return z[Y]=V,K.methods.push(z),K}gHSets(Y,J,Z){const K=[];for(let Q=0,X=Y.methods.length;Q<X;Q++){const H=Y.methods[Q],z=H[J]||H[j];if(z!==void 0)z.params={},z.possibleKeys.map((V)=>{z.params[V]=Z[V]}),K.push(z)}return K}search(Y,J){const Z=[],K={};this.params={};let X=[this];const H=OY(J);for(let V=0,W=H.length;V<W;V++){const U=H[V],N=V===W-1,M=[];for(let B=0,S=X.length;B<S;B++){const C=X[B],I=C.children[U];if(I)if(I.params=C.params,N===!0){if(I.children["*"])Z.push(...this.gHSets(I.children["*"],Y,C.params));Z.push(...this.gHSets(I,Y,C.params))}else M.push(I);for(let T=0,$=C.patterns.length;T<$;T++){const y=C.patterns[T];if(y==="*"){const h=C.children["*"];if(h)Z.push(...this.gHSets(h,Y,C.params)),M.push(h);continue}if(U==="")continue;const[v,Y1,c]=y,t=C.children[v],j1=H.slice(V).join("/");if(c instanceof RegExp&&c.test(j1)){K[Y1]=j1,Z.push(...this.gHSets(t,Y,{...K,...C.params}));continue}if(c===!0||c instanceof RegExp&&c.test(U)){if(typeof v==="string")if(K[Y1]=U,N===!0){if(Z.push(...this.gHSets(t,Y,{...K,...C.params})),t.children["*"])Z.push(...this.gHSets(t.children["*"],Y,{...K,...C.params}))}else t.params={...K},M.push(t)}}}X=M}return[Z.sort((V,W)=>{return V.score-W.score}).map(({handler:V,params:W})=>[V,W])]}};var $0=class{constructor(){this.name="TrieRouter",this.node=new T0}add(Y,J,Z){const K=l1(J);if(K){for(let Q of K)this.node.insert(Y,Q,Z);return}this.node.insert(Y,J,Z)}match(Y,J){return this.node.search(Y,J)}};var g1=class extends uY{constructor(Y={}){super(Y);this.router=Y.router??new S0({routers:[new G0,new $0]})}};var cY=(Y={space:2})=>{return async function J(Z,K){const Q=Z.req.query("pretty")||Z.req.query("pretty")===""?!0:!1;if(await K(),Q&&Z.res.headers.get("Content-Type")?.startsWith("application/json")){const X=await Z.res.json();Z.res=new Response(JSON.stringify(X,null,Y.space),Z.res)}}};var ZJ=function(Y){return Y!==null&&Y!==void 0},K1=function(Y){return Y.filter(ZJ)},KJ=function(Y){return Object.fromEntries(Object.entries(Y).filter(([,J])=>ZJ(J)))},KY=function(Y){try{return Y instanceof Blob}catch(J){return!1}},O=function(Y){return Boolean(Y)&&typeof Y==="object"&&!Array.isArray(Y)&&!(Y instanceof Date)&&!KY(Y)},G=function(Y){return Y!==null&&Y!==void 0},A=function(Y){return G(Y)&&typeof Y==="string"},QJ=function(Y){return G(Y)&&Array.isArray(Y)&&Y.every(A)},XJ=function(Y){return G(Y)&&typeof Y==="number"},MZ=function(Y){if(XJ(Y))return Y;if(A(Y)){const J=Number(Y);if(!Number.isNaN(J))return J}return},qZ=function(Y){try{return btoa(Y)}catch(J){return Buffer.from(Y).toString("base64")}},HJ=function(Y,J){const Z={...Y};for(let[K,Q]of Object.entries(J))if(O(Q)&&O(Z[K]))Z[K]=HJ(Z[K],Q);else Z[K]=Q;return Z},QY=function(Y,J){const Z=[];for(let K=0;K<Y.length;K+=J)Z.push(Y.slice(K,K+J));return Z};async function EZ(Y){return new Promise((J)=>setTimeout(J,Y))}var OZ=function(Y){let J;const Z=new Promise((K)=>{J=setTimeout(()=>{K()},Y)});return{cancel:()=>clearTimeout(J),promise:Z}},XY=function(Y,J){const Z=(K,Q)=>K.then((X)=>J(Q).then((H)=>{return X.push(H),X}));return Y.reduce(Z,Promise.resolve([]))},q0=function(){try{if(G(process)&&G(process.env))return{apiKey:process.env.XATA_API_KEY??P0(),databaseURL:process.env.XATA_DATABASE_URL??j0(),branch:process.env.XATA_BRANCH??f0(),deployPreview:process.env.XATA_PREVIEW,deployPreviewBranch:process.env.XATA_PREVIEW_BRANCH,vercelGitCommitRef:process.env.VERCEL_GIT_COMMIT_REF,vercelGitRepoOwner:process.env.VERCEL_GIT_REPO_OWNER}}catch(Y){}try{if(O(Deno)&&O(Deno.env))return{apiKey:Deno.env.get("XATA_API_KEY")??P0(),databaseURL:Deno.env.get("XATA_DATABASE_URL")??j0(),branch:Deno.env.get("XATA_BRANCH")??f0(),deployPreview:Deno.env.get("XATA_PREVIEW"),deployPreviewBranch:Deno.env.get("XATA_PREVIEW_BRANCH"),vercelGitCommitRef:Deno.env.get("VERCEL_GIT_COMMIT_REF"),vercelGitRepoOwner:Deno.env.get("VERCEL_GIT_REPO_OWNER")}}catch(Y){}return{apiKey:P0(),databaseURL:j0(),branch:f0(),deployPreview:void 0,deployPreviewBranch:void 0,vercelGitCommitRef:void 0,vercelGitRepoOwner:void 0}},BZ=function(){try{if(O(process)&&O(process.env)&&process.env.XATA_ENABLE_BROWSER!==void 0)return process.env.XATA_ENABLE_BROWSER==="true"}catch(Y){}try{if(O(Deno)&&O(Deno.env)&&Deno.env.get("XATA_ENABLE_BROWSER")!==void 0)return Deno.env.get("XATA_ENABLE_BROWSER")==="true"}catch(Y){}try{return XATA_ENABLE_BROWSER===!0||XATA_ENABLE_BROWSER==="true"}catch(Y){return}},P0=function(){try{return XATA_API_KEY}catch(Y){return}},j0=function(){try{return XATA_DATABASE_URL}catch(Y){return}},f0=function(){try{return XATA_BRANCH}catch(Y){return}},CZ=function(){try{const{databaseURL:Y}=q0();return Y}catch(Y){return}},FZ=function(){try{const{apiKey:Y}=q0();return Y}catch(Y){return}},wZ=function(){try{const{branch:Y}=q0();return Y}catch(Y){return}},IZ=function({org:Y,branch:J}){return`preview-${Y}-${J}`},RZ=function(){try{const{deployPreview:Y,deployPreviewBranch:J,vercelGitCommitRef:Z,vercelGitRepoOwner:K}=q0();if(J)return J;switch(Y){case"vercel":{if(!Z||!K){console.warn("XATA_PREVIEW=vercel but VERCEL_GIT_COMMIT_REF or VERCEL_GIT_REPO_OWNER is not valid");return}return IZ({org:K,branch:Z})}}return}catch(Y){return}},GZ=function(Y){const J=typeof fetch!=="undefined"?fetch:void 0,Z=typeof globalThis!=="undefined"?globalThis.fetch:void 0,K=Y??J??Z;if(!K)throw new Error("Couldn't find a global \`fetch\`. Pass a fetch implementation explicitly.");return K},b1=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(Y){const J=Math.random()*16|0;return(Y=="x"?J:J&3|8).toString(16)})};async function SZ(Y,J){const Z=Y.getReader();let K;while(!(K=await Z.read()).done)J(K.value)}var TZ=function(Y){let J,Z,K,Q=!1;return function X(H){if(J===void 0)J=H,Z=0,K=-1;else J=PZ(J,H);const z=J.length;let V=0;while(Z<z){if(Q){if(J[Z]===10)V=++Z;Q=!1}let W=-1;for(;Z<z&&W===-1;++Z)switch(J[Z]){case 58:if(K===-1)K=Z-V;break;case 13:Q=!0;case 10:W=Z;break}if(W===-1)break;Y(J.subarray(V,W),K),V=Z,K=-1}if(V===z)J=void 0;else if(V!==0)J=J.subarray(V),Z-=V}},$Z=function(Y,J,Z){let K=pY();const Q=new TextDecoder;return function X(H,z){if(H.length===0)Z?.(K),K=pY();else if(z>0){const V=Q.decode(H.subarray(0,z)),W=z+(H[z+1]===32?2:1),U=Q.decode(H.subarray(W));switch(V){case"data":K.data=K.data?K.data+"\n"+U:U;break;case"event":K.event=U;break;case"id":Y(K.id=U);break;case"retry":const N=parseInt(U,10);if(!isNaN(N))J(K.retry=N);break}}}},PZ=function(Y,J){const Z=new Uint8Array(Y.length+J.length);return Z.set(Y),Z.set(J,Y.length),Z},pY=function(){return{data:"",event:"",id:"",retry:void 0}},jZ=function(Y,{signal:J,headers:Z,onopen:K,onmessage:Q,onclose:X,onerror:H,fetch:z,...V}){return new Promise((W,U)=>{const N={...Z};if(!N.accept)N.accept=u0;let M;function B(){M.abort()}J?.addEventListener("abort",()=>{B(),W()});const S=z??fetch,C=K??fZ;async function I(){M=new AbortController;try{const T=await S(Y,{...V,headers:N,signal:M.signal});await C(T),await SZ(T.body,TZ($Z(($)=>{if($)N[lY]=$;else delete N[lY]},($)=>{},Q))),X?.(),B(),W()}catch(T){}}I()})},fZ=function(Y){const J=Y.headers?.get("content-type");if(!J?.startsWith(u0))throw new Error(`Expected content-type to be ${u0}, Actual: ${J}`)},NJ=function(Y){return O(Y)&&Array.isArray(Y.errors)},kZ=function(Y){return O(Y)&&A(Y.message)},nY=function(Y){if(Y instanceof Error)return Y.message;else if(A(Y))return Y;else if(kZ(Y))return Y.message;else if(NJ(Y))return"Bulk operation failed";else return"Unexpected error"};var vZ=function(Y){return A(Y)&&Object.keys(yZ).includes(Y)};var gZ=function(Y){if(!A(Y))return null;const J={production:Y.match(/(?:https:\/\/)?([^.]+)(?:\.([^.]+))\.xata\.sh.*/),staging:Y.match(/(?:https:\/\/)?([^.]+)(?:\.([^.]+))\.staging-xata\.dev.*/),dev:Y.match(/(?:https:\/\/)?([^.]+)(?:\.([^.]+))\.dev-xata\.dev.*/)},[Z,K]=Object.entries(J).find(([,Q])=>Q!==null)??[];if(!vZ(Z)||!K)return null;return{workspace:K[1],region:K[2],host:Z}},UJ=function({method:Y,endpoint:J,path:Z,workspacesApiUrl:K,apiUrl:Q,pathParams:X={}}){if(J==="dataPlane"){let H=A(K)?`${K}${Z}`:K(Z,X);if(Y.toUpperCase()==="PUT"&&["/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file","/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}"].includes(Z)){const{host:V}=gZ(H)??{};switch(V){case"production":H=H.replace("xata.sh","upload.xata.sh");break;case"staging":H=H.replace("staging-xata.dev","upload.staging-xata.dev");break;case"dev":H=H.replace("dev-xata.dev","upload.dev-xata.dev");break}}const z=A(X.workspace)?H.replace("{workspaceId}",String(X.workspace)):H;return A(X.region)?z.replace("{region}",String(X.region)):z}return`${Q}${Z}`},hZ=function(Y){const J=/.*:\/\/(?<host>[^/]+).*/,{groups:Z}=J.exec(Y)??{};return Z?.host?{Host:Z.host}:{}};async function _Z(Y,J){if(!G(Y))return;if(KY(Y)||typeof Y.text==="function")return Y;const{"Content-Type":Z}=J??{};if(String(Z).toLowerCase()==="application/json"&&O(Y))return JSON.stringify(Y);return Y}async function DJ({url:Y,method:J,body:Z,headers:K,pathParams:Q,queryParams:X,fetch:H,apiKey:z,endpoint:V,apiUrl:W,workspacesApiUrl:U,trace:N,signal:M,clientID:B,sessionID:S,clientName:C,xataAgentExtra:I,fetchOptions:T={},rawResponse:$=!1}){return oY.setFetch(H),await N(`${J.toUpperCase()} ${Y}`,async({setAttributes:y})=>{const v=UJ({method:J,endpoint:V,path:Y,workspacesApiUrl:U,pathParams:Q,apiUrl:W}),Y1=m0(v,X,Q),c=Y1.includes("localhost")?Y1.replace(/^[^.]+\./,"http://"):Y1;y({[n.HTTP_URL]:c,[n.HTTP_TARGET]:m0(Y,X,Q)});const t=K1([["client","TS_SDK"],["version",zY],G(C)?["service",C]:void 0,...Object.entries(I??{})]).map(([D1,ZZ])=>`${D1}=${ZZ}`).join("; "),j1=KJ({"Accept-Encoding":"identity","Content-Type":"application/json","X-Xata-Client-ID":B??LJ,"X-Xata-Session-ID":S??b1(),"X-Xata-Agent":t,...K,...hZ(Y1),Authorization:`Bearer ${z}`}),h=await oY.request(c,{...T,method:J.toUpperCase(),body:await _Z(Z,j1),headers:j1,signal:M}),{host:YZ,protocol:JZ}=mZ(h.url),c1=h.headers?.get("x-request-id")??void 0;y({[n.KIND]:"http",[n.HTTP_REQUEST_ID]:c1,[n.HTTP_STATUS_CODE]:h.status,[n.HTTP_HOST]:YZ,[n.HTTP_SCHEME]:JZ?.replace(":",""),[n.CLOUDFLARE_RAY_ID]:h.headers?.get("cf-ray")??void 0});const EY=h.headers?.get("x-xata-message");if(EY)console.warn(EY);if(h.status===204)return{};if(h.status===429)throw new K0(h.status,"Rate limit exceeded",c1);try{const D1=$?await h.blob():await h.json();if(h.ok)return D1;throw new K0(h.status,D1,c1)}catch(D1){throw new K0(h.status,D1,c1)}},{[n.HTTP_METHOD]:J.toUpperCase(),[n.HTTP_ROUTE]:Y})}var uZ=function({url:Y,method:J,body:Z,headers:K,pathParams:Q,queryParams:X,fetch:H,apiKey:z,endpoint:V,apiUrl:W,workspacesApiUrl:U,onMessage:N,onError:M,onClose:B,signal:S,clientID:C,sessionID:I,clientName:T,xataAgentExtra:$}){const y=UJ({method:J,endpoint:V,path:Y,workspacesApiUrl:U,pathParams:Q,apiUrl:W}),v=m0(y,X,Q),Y1=v.includes("localhost")?v.replace(/^[^.]+\./,"http://"):v;jZ(Y1,{method:J,body:JSON.stringify(Z),fetch:H,signal:S,headers:{"X-Xata-Client-ID":C??LJ,"X-Xata-Session-ID":I??b1(),"X-Xata-Agent":K1([["client","TS_SDK"],["version",zY],G(T)?["service",T]:void 0,...Object.entries($??{})]).map(([c,t])=>`${c}=${t}`).join("; "),...K,Authorization:`Bearer ${z}`,"Content-Type":"application/json"},onmessage(c){N?.(JSON.parse(c.data))},onerror(c){M?.(JSON.parse(c.data))},onclose(){B?.()}})},mZ=function(Y){try{const{host:J,protocol:Z}=new URL(Y);return{host:J,protocol:Z}}catch(J){return{}}},S7=function(Y){return Y.flatMap((J)=>Object.entries(J).map(([Z,K])=>{if(Z==="trim"){const{left:Q=0,top:X=0,right:H=0,bottom:z=0}=K;return`${Z}=${[X,H,z,Q].join(";")}`}if(Z==="gravity"&&typeof K==="object"){const{x:Q=0.5,y:X=0.5}=K;return`${Z}=${[Q,X].join("x")}`}return`${Z}=${K}`})).join(",")},e1=function(Y,...J){if(!G(Y))return;const Z=S7(J),{hostname:K,pathname:Q,search:X}=new URL(Y),H=Q.split("/"),z=H.findIndex((N)=>N==="transform"),W=`/transform/${[(z>=0?H.splice(z,2):[])[1],Z].filter(G).join(",")}`,U=H.join("/");return`https://${K}${W}${U}${X}`},M0=function(Y){if(!G(Y))return;if(!O(Y))return Y;const J=Object.fromEntries(Object.entries(Y).reduce((Z,[K,Q])=>{if(!G(Q))return Z;if(Array.isArray(Q)){const X=Q.map((H)=>M0(H)).filter((H)=>G(H));if(X.length===0)return Z;return[...Z,[K,X]]}if(O(Q)){const X=M0(Q);if(!G(X))return Z;return[...Z,[K,X]]}return[...Z,[K,Q]]},[]));return Object.keys(J).length>0?J:void 0},T7=function(Y){if(!G(Y))return Y;if(A(Y))return Y;try{return JSON.stringify(Y)}catch(J){return Y}},$7=function(Y){try{return JSON.parse(Y)}catch(J){return Y}},P7=function(Y){return G(Y)&&(G(Y.start)||G(Y.end)||G(Y.after)||G(Y.before))},y7=function(Y,J){if(P7(Y.pagination))return{...J,sort:void 0,filter:void 0};return J},v7=function(Y){return O(Y)&&A(Y?.id)};var g7=function(Y){return O(Y)&&A(Y.name)},b=function(Y){if(!Array.isArray(Y))return!1;return Y.every((J)=>{if(typeof J==="string")return!0;if(typeof J==="object")return g7(J);return!1})},h7=function(Y){return A(Y)},yJ=function(Y){return O(Y)&&Object.entries(Y).every(([J,Z])=>{if(J==="*")return Z==="random";return Z==="asc"||Z==="desc"})},_7=function(Y){return O(Y)&&!yJ(Y)&&Y.column!==void 0},p0=function(Y){if(h7(Y))return{[Y]:"asc"};else if(Array.isArray(Y))return Y.map((J)=>p0(J));else if(yJ(Y))return Y;else if(_7(Y))return{[Y.column]:Y.direction??"asc"};else throw new Error(`Invalid sort filter: ${Y}`)},H1=function(Y){if(A(Y))return Y;if(O(Y)&&A(Y.id))return Y.id;return},u7=function(Y,J){if(Y.includes("*"))return!0;return Y.filter((Z)=>A(Z)&&Z.startsWith(J.name)).length>0},A1=function(...Y){for(let J of Y)if(O(J)&&XJ(J.ifVersion))return J.ifVersion;return},c7=function(Y){if(typeof Y==="string")return"text/plain";if("mediaType"in Y&&Y.mediaType!==void 0)return Y.mediaType;if(KY(Y))return Y.type;try{return Y.type}catch(J){}return"application/octet-stream"},p7=function(Y){return'"'+Y.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},nJ=function(Y){let J="{";for(let Z=0;Z<Y.length;Z++){if(Z>0)J=J+",";if(Y[Z]===null||typeof Y[Z]==="undefined")J=J+"NULL";else if(Array.isArray(Y[Z]))J=J+nJ(Y[Z]);else if(Y[Z]instanceof Buffer)J+="\\\\x"+Y[Z].toString("hex");else J+=p7(L0(Y[Z]))}return J=J+"}",J},L0=function(Y){if(!G(Y))return null;if(Y instanceof Date)return Y.toISOString();if(Array.isArray(Y))return nJ(Y);if(O(Y))return JSON.stringify(Y);try{return Y.toString()}catch(J){return Y}},l7=function(Y,J){if(A(Y))return{statement:Y,params:J?.map((Z)=>L0(Z))};if(QJ(Y))return{statement:Y.reduce((K,Q,X)=>{return K+Q+(X<(J?.length??0)?"$"+(X+1):"")},""),params:J?.map((K)=>L0(K))};if(O(Y)){const{statement:Z,params:K,consistency:Q}=Y;return{statement:Z,params:K?.map((X)=>L0(X)),consistency:Q}}throw new Error("Invalid query")},JJ=async(Y,J,Z)=>{return await J({name:Y,setAttributes:()=>{return}})},n={KIND:"xata.trace.kind",VERSION:"xata.sdk.version",TABLE:"xata.table",HTTP_REQUEST_ID:"http.request_id",HTTP_STATUS_CODE:"http.status_code",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_USER_AGENT:"http.user_agent",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_ROUTE:"http.route",HTTP_TARGET:"http.target",CLOUDFLARE_RAY_ID:"cf.ray"},HY=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},R1=(Y,J,Z)=>{return HY(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},a1=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},k0=(Y,J,Z,K)=>{return HY(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},AZ=(Y,J,Z)=>{return HY(Y,J,"access private method"),Z},_1,x1,D0,_0,zJ,xZ=300000;class VJ{constructor(Y=10){a1(this,_0),a1(this,_1,void 0),a1(this,x1,void 0),a1(this,D0,void 0),k0(this,x1,[]),k0(this,D0,Y),this.running=0,this.started=0}setFetch(Y){k0(this,_1,Y)}getFetch(){if(!R1(this,_1))throw new Error("Fetch not set");return R1(this,_1)}request(Y,J){const Z=new Date,K=this.getFetch(),Q=async(X=!1)=>{const{promise:H,cancel:z}=OZ(xZ),V=await Promise.race([K(Y,J),H.then(()=>null)]).finally(z);if(!V)throw new Error("Request timed out");if(V.status===429){const W=MZ(V.headers?.get("x-ratelimit-reset"))??1;return await EZ(W*1000),await Q(!0)}if(X){const W=(new Date()).getTime()-Z.getTime();console.warn(`A request to Xata hit branch rate limits, was retried and stalled for ${W}ms`)}return V};return AZ(this,_0,zJ).call(this,async()=>{return await Q()})}}_1=new WeakMap;x1=new WeakMap;D0=new WeakMap;_0=new WeakSet;zJ=function(Y){const J=new Promise((Z)=>R1(this,x1).push(Z)).finally(()=>{this.started--,this.running++}).then(()=>Y()).finally(()=>{this.running--;const Z=R1(this,x1).shift();if(Z!==void 0)this.started++,Z()});if(this.running+this.started<R1(this,D0)){const Z=R1(this,x1).shift();if(Z!==void 0)this.started++,Z()}return J};var u0="text/event-stream",lY="last-event-id",zY="0.28.3";class WJ extends Error{constructor(Y,J){super(Y,J)}}class K0 extends WJ{constructor(Y,J,Z){super(nY(J));if(this.status=Y,this.errors=NJ(J)?J.errors:[{message:nY(J),status:Y}],this.requestId=Z,J instanceof Error)this.stack=J.stack,this.cause=J.cause}toString(){const Y=super.toString();return`[${this.status}] (${this.requestId??"Unknown"}): ${Y}`}}var yZ={production:{main:"https://api.xata.io",workspaces:"https://{workspaceId}.{region}.xata.sh"},staging:{main:"https://api.staging-xata.dev",workspaces:"https://{workspaceId}.{region}.staging-xata.dev"},dev:{main:"https://api.dev-xata.dev",workspaces:"https://{workspaceId}.{region}.dev-xata.dev"}},oY=new VJ,m0=(Y,J={},Z={})=>{const K=Object.entries(J).reduce((z,[V,W])=>{if(W===void 0||W===null)return z;return{...z,[V]:W}},{}),Q=new URLSearchParams(K).toString(),X=Q.length>0?`?${Q}`:"",H=Object.entries(Z).reduce((z,[V,W])=>{return{...z,[V]:encodeURIComponent(String(W??"")).replace("%3A",":")}},{});return Y.replace(/\{\w*\}/g,(z)=>H[z.slice(1,-1)])+X},LJ=b1(),D=async(Y)=>DJ({...Y,endpoint:"dataPlane"}),bZ=(Y,J)=>D({url:"/db/{dbBranchName}/pgroll/apply",method:"post",...Y,signal:J}),dZ=(Y,J)=>D({url:"/db/{dbBranchName}/pgroll/status",method:"get",...Y,signal:J}),cZ=(Y,J)=>D({url:"/db/{dbBranchName}/pgroll/jobs/{jobId}",method:"get",...Y,signal:J}),pZ=(Y,J)=>D({url:"/dbs/{dbName}",method:"get",...Y,signal:J}),VY=(Y,J)=>D({url:"/db/{dbBranchName}",method:"get",...Y,signal:J}),lZ=(Y,J)=>D({url:"/db/{dbBranchName}",method:"put",...Y,signal:J}),nZ=(Y,J)=>D({url:"/db/{dbBranchName}",method:"delete",...Y,signal:J}),oZ=(Y,J)=>D({url:"/db/{dbBranchName}/schema",method:"get",...Y,signal:J}),iZ=(Y,J)=>D({url:"/db/{dbBranchName}/copy",method:"post",...Y,signal:J}),sZ=(Y,J)=>D({url:"/db/{dbBranchName}/metadata",method:"put",...Y,signal:J}),rZ=(Y,J)=>D({url:"/db/{dbBranchName}/metadata",method:"get",...Y,signal:J}),tZ=(Y,J)=>D({url:"/db/{dbBranchName}/stats",method:"get",...Y,signal:J}),aZ=(Y,J)=>D({url:"/dbs/{dbName}/gitBranches",method:"get",...Y,signal:J}),eZ=(Y,J)=>D({url:"/dbs/{dbName}/gitBranches",method:"post",...Y,signal:J}),Y4=(Y,J)=>D({url:"/dbs/{dbName}/gitBranches",method:"delete",...Y,signal:J}),J4=(Y,J)=>D({url:"/dbs/{dbName}/resolveBranch",method:"get",...Y,signal:J}),Z4=(Y,J)=>D({url:"/db/{dbBranchName}/migrations",method:"get",...Y,signal:J}),K4=(Y,J)=>D({url:"/db/{dbBranchName}/migrations/plan",method:"post",...Y,signal:J}),Q4=(Y,J)=>D({url:"/db/{dbBranchName}/migrations/execute",method:"post",...Y,signal:J}),X4=(Y,J)=>D({url:"/dbs/{dbName}/migrations/query",method:"post",...Y,signal:J}),H4=(Y,J)=>D({url:"/dbs/{dbName}/migrations",method:"post",...Y,signal:J}),z4=(Y,J)=>D({url:"/dbs/{dbName}/migrations/{mrNumber}",method:"get",...Y,signal:J}),V4=(Y,J)=>D({url:"/dbs/{dbName}/migrations/{mrNumber}",method:"patch",...Y,signal:J}),W4=(Y,J)=>D({url:"/dbs/{dbName}/migrations/{mrNumber}/commits",method:"post",...Y,signal:J}),N4=(Y,J)=>D({url:"/dbs/{dbName}/migrations/{mrNumber}/compare",method:"post",...Y,signal:J}),U4=(Y,J)=>D({url:"/dbs/{dbName}/migrations/{mrNumber}/merge",method:"get",...Y,signal:J}),L4=(Y,J)=>D({url:"/dbs/{dbName}/migrations/{mrNumber}/merge",method:"post",...Y,signal:J}),D4=(Y,J)=>D({url:"/db/{dbBranchName}/schema/history",method:"post",...Y,signal:J}),M4=(Y,J)=>D({url:"/db/{dbBranchName}/schema/compare",method:"post",...Y,signal:J}),q4=(Y,J)=>D({url:"/db/{dbBranchName}/schema/compare/{branchName}",method:"post",...Y,signal:J}),E4=(Y,J)=>D({url:"/db/{dbBranchName}/schema/update",method:"post",...Y,signal:J}),O4=(Y,J)=>D({url:"/db/{dbBranchName}/schema/preview",method:"post",...Y,signal:J}),B4=(Y,J)=>D({url:"/db/{dbBranchName}/schema/apply",method:"post",...Y,signal:J}),C4=(Y,J)=>D({url:"/db/{dbBranchName}/schema/push",method:"post",...Y,signal:J}),F4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}",method:"put",...Y,signal:J}),w4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}",method:"delete",...Y,signal:J}),I4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}",method:"patch",...Y,signal:J}),R4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/schema",method:"get",...Y,signal:J}),A4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/schema",method:"put",...Y,signal:J}),x4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/columns",method:"get",...Y,signal:J}),G4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/columns",method:"post",...Y,signal:J}),S4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/columns/{columnName}",method:"get",...Y,signal:J}),T4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/columns/{columnName}",method:"patch",...Y,signal:J}),$4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/columns/{columnName}",method:"delete",...Y,signal:J}),d1=(Y,J)=>D({url:"/db/{dbBranchName}/transaction",method:"post",...Y,signal:J}),MJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data",method:"post",...Y,signal:J}),qJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}",method:"get",...Y,signal:J}),EJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}",method:"put",...Y,signal:J}),OJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}",method:"delete",...Y,signal:J}),P4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file",method:"get",...Y,signal:J}),j4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file",method:"put",...Y,signal:J}),f4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file",method:"delete",...Y,signal:J}),BJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"get",...Y,signal:J}),CJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"put",...Y,signal:J}),FJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"patch",...Y,signal:J}),wJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"post",...Y,signal:J}),IJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"delete",...Y,signal:J}),k4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/bulk",method:"post",...Y,signal:J}),RJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/query",method:"post",...Y,signal:J}),AJ=(Y,J)=>D({url:"/db/{dbBranchName}/search",method:"post",...Y,signal:J}),xJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/search",method:"post",...Y,signal:J}),GJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/vectorSearch",method:"post",...Y,signal:J}),y4=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/ask",method:"post",...Y,signal:J}),SJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/ask/{sessionId}",method:"post",...Y,signal:J}),TJ=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/summarize",method:"post",...Y,signal:J}),$J=(Y,J)=>D({url:"/db/{dbBranchName}/tables/{tableName}/aggregate",method:"post",...Y,signal:J}),v4=(Y,J)=>D({url:"/file/{fileId}",method:"get",...Y,signal:J}),g4=(Y,J)=>D({url:"/file/{fileId}",method:"put",...Y,signal:J}),PJ=(Y,J)=>D({url:"/db/{dbBranchName}/sql",method:"post",...Y,signal:J}),h4={branch:{applyMigration:bZ,pgRollStatus:dZ,pgRollJobStatus:cZ,getBranchList:pZ,getBranchDetails:VY,createBranch:lZ,deleteBranch:nZ,copyBranch:iZ,updateBranchMetadata:sZ,getBranchMetadata:rZ,getBranchStats:tZ,getGitBranchesMapping:aZ,addGitBranchesEntry:eZ,removeGitBranchesEntry:Y4,resolveBranch:J4},migrations:{getSchema:oZ,getBranchMigrationHistory:Z4,getBranchMigrationPlan:K4,executeBranchMigrationPlan:Q4,getBranchSchemaHistory:D4,compareBranchWithUserSchema:M4,compareBranchSchemas:q4,updateBranchSchema:E4,previewBranchSchemaEdit:O4,applyBranchSchemaEdit:B4,pushBranchMigrations:C4},migrationRequests:{queryMigrationRequests:X4,createMigrationRequest:H4,getMigrationRequest:z4,updateMigrationRequest:V4,listMigrationRequestsCommits:W4,compareMigrationRequest:N4,getMigrationRequestIsMerged:U4,mergeMigrationRequest:L4},table:{createTable:F4,deleteTable:w4,updateTable:I4,getTableSchema:R4,setTableSchema:A4,getTableColumns:x4,addTableColumn:G4,getColumn:S4,updateColumn:T4,deleteColumn:$4},records:{branchTransaction:d1,insertRecord:MJ,getRecord:BJ,insertRecordWithID:CJ,updateRecordWithID:FJ,upsertRecordWithID:wJ,deleteRecord:IJ,bulkInsertTableRecords:k4},files:{getFileItem:qJ,putFileItem:EJ,deleteFileItem:OJ,getFile:P4,putFile:j4,deleteFile:f4,fileAccess:v4,fileUpload:g4},searchAndFilter:{queryTable:RJ,searchBranch:AJ,searchTable:xJ,vectorSearchTable:GJ,askTable:y4,askTableSession:SJ,summarizeTable:TJ,aggregateTable:$J},sql:{sqlQuery:PJ}},F=async(Y)=>DJ({...Y,endpoint:"controlPlane"}),_4=(Y,J)=>F({url:"/oauth/authorize",method:"get",...Y,signal:J}),u4=(Y,J)=>F({url:"/oauth/authorize",method:"post",...Y,signal:J}),m4=(Y,J)=>F({url:"/user",method:"get",...Y,signal:J}),b4=(Y,J)=>F({url:"/user",method:"put",...Y,signal:J}),d4=(Y,J)=>F({url:"/user",method:"delete",...Y,signal:J}),c4=(Y,J)=>F({url:"/user/keys",method:"get",...Y,signal:J}),p4=(Y,J)=>F({url:"/user/keys/{keyName}",method:"post",...Y,signal:J}),l4=(Y,J)=>F({url:"/user/keys/{keyName}",method:"delete",...Y,signal:J}),n4=(Y,J)=>F({url:"/user/oauth/clients",method:"get",...Y,signal:J}),o4=(Y,J)=>F({url:"/user/oauth/clients/{clientId}",method:"delete",...Y,signal:J}),i4=(Y,J)=>F({url:"/user/oauth/tokens",method:"get",...Y,signal:J}),s4=(Y,J)=>F({url:"/user/oauth/tokens/{token}",method:"delete",...Y,signal:J}),r4=(Y,J)=>F({url:"/user/oauth/tokens/{token}",method:"patch",...Y,signal:J}),t4=(Y,J)=>F({url:"/workspaces",method:"get",...Y,signal:J}),a4=(Y,J)=>F({url:"/workspaces",method:"post",...Y,signal:J}),e4=(Y,J)=>F({url:"/workspaces/{workspaceId}",method:"get",...Y,signal:J}),Y7=(Y,J)=>F({url:"/workspaces/{workspaceId}",method:"put",...Y,signal:J}),J7=(Y,J)=>F({url:"/workspaces/{workspaceId}",method:"delete",...Y,signal:J}),Z7=(Y,J)=>F({url:"/workspaces/{workspaceId}/members",method:"get",...Y,signal:J}),K7=(Y,J)=>F({url:"/workspaces/{workspaceId}/members/{userId}",method:"put",...Y,signal:J}),Q7=(Y,J)=>F({url:"/workspaces/{workspaceId}/members/{userId}",method:"delete",...Y,signal:J}),X7=(Y,J)=>F({url:"/workspaces/{workspaceId}/invites",method:"post",...Y,signal:J}),H7=(Y,J)=>F({url:"/workspaces/{workspaceId}/invites/{inviteId}",method:"patch",...Y,signal:J}),z7=(Y,J)=>F({url:"/workspaces/{workspaceId}/invites/{inviteId}",method:"delete",...Y,signal:J}),V7=(Y,J)=>F({url:"/workspaces/{workspaceId}/invites/{inviteKey}/accept",method:"post",...Y,signal:J}),W7=(Y,J)=>F({url:"/workspaces/{workspaceId}/invites/{inviteId}/resend",method:"post",...Y,signal:J}),N7=(Y,J)=>F({url:"/workspaces/{workspaceId}/clusters",method:"get",...Y,signal:J}),U7=(Y,J)=>F({url:"/workspaces/{workspaceId}/clusters",method:"post",...Y,signal:J}),L7=(Y,J)=>F({url:"/workspaces/{workspaceId}/clusters/{clusterId}",method:"get",...Y,signal:J}),D7=(Y,J)=>F({url:"/workspaces/{workspaceId}/clusters/{clusterId}",method:"patch",...Y,signal:J}),M7=(Y,J)=>F({url:"/workspaces/{workspaceId}/dbs",method:"get",...Y,signal:J}),q7=(Y,J)=>F({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"put",...Y,signal:J}),E7=(Y,J)=>F({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"delete",...Y,signal:J}),O7=(Y,J)=>F({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"get",...Y,signal:J}),B7=(Y,J)=>F({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"patch",...Y,signal:J}),C7=(Y,J)=>F({url:"/workspaces/{workspaceId}/dbs/{dbName}/rename",method:"post",...Y,signal:J}),F7=(Y,J)=>F({url:"/workspaces/{workspaceId}/dbs/{dbName}/github",method:"get",...Y,signal:J}),w7=(Y,J)=>F({url:"/workspaces/{workspaceId}/dbs/{dbName}/github",method:"put",...Y,signal:J}),I7=(Y,J)=>F({url:"/workspaces/{workspaceId}/dbs/{dbName}/github",method:"delete",...Y,signal:J}),R7=(Y,J)=>F({url:"/workspaces/{workspaceId}/regions",method:"get",...Y,signal:J}),A7={oAuth:{getAuthorizationCode:_4,grantAuthorizationCode:u4,getUserOAuthClients:n4,deleteUserOAuthClient:o4,getUserOAuthAccessTokens:i4,deleteOAuthAccessToken:s4,updateOAuthAccessToken:r4},users:{getUser:m4,updateUser:b4,deleteUser:d4},authentication:{getUserAPIKeys:c4,createUserAPIKey:p4,deleteUserAPIKey:l4},workspaces:{getWorkspacesList:t4,createWorkspace:a4,getWorkspace:e4,updateWorkspace:Y7,deleteWorkspace:J7,getWorkspaceMembersList:Z7,updateWorkspaceMemberRole:K7,removeWorkspaceMember:Q7},invites:{inviteWorkspaceMember:X7,updateWorkspaceMemberInvite:H7,cancelWorkspaceMemberInvite:z7,acceptWorkspaceMemberInvite:V7,resendWorkspaceMemberInvite:W7},xbcontrolOther:{listClusters:N7,createCluster:U7,getCluster:L7,updateCluster:D7},databases:{getDatabaseList:M7,createDatabase:q7,deleteDatabase:E7,getDatabaseMetadata:O7,updateDatabaseMetadata:B7,renameDatabase:C7,getDatabaseGithubSettings:F7,updateDatabaseGithubSettings:w7,deleteDatabaseGithubSettings:I7,listRegions:R7}},CK=HJ(h4,A7);var x7,G7;x7=new WeakMap;G7=new WeakMap;class $1{}class V1{constructor(Y){this.id=Y.id,this.name=Y.name,this.mediaType=Y.mediaType,this.base64Content=Y.base64Content,this.enablePublicUrl=Y.enablePublicUrl,this.signedUrlTimeout=Y.signedUrlTimeout,this.uploadUrlTimeout=Y.uploadUrlTimeout,this.size=Y.size,this.version=Y.version,this.url=Y.url,this.signedUrl=Y.signedUrl,this.uploadUrl=Y.uploadUrl,this.attributes=Y.attributes}static fromBuffer(Y,J={}){const Z=Y.toString("base64");return new V1({...J,base64Content:Z})}toBuffer(){if(!this.base64Content)throw new Error('File content is not available, please select property "base64Content" when querying the file');return Buffer.from(this.base64Content,"base64")}static fromArrayBuffer(Y,J={}){const Z=new Uint8Array(Y);return this.fromUint8Array(Z,J)}toArrayBuffer(){if(!this.base64Content)throw new Error('File content is not available, please select property "base64Content" when querying the file');const Y=atob(this.base64Content);return new ArrayBuffer(Y.length)}static fromUint8Array(Y,J={}){let Z="";for(let Q=0;Q<Y.byteLength;Q++)Z+=String.fromCharCode(Y[Q]);const K=btoa(Z);return new V1({...J,base64Content:K})}toUint8Array(){if(!this.base64Content)throw new Error('File content is not available, please select property "base64Content" when querying the file');const Y=atob(this.base64Content),J=new Uint8Array(Y.length);for(let Z=0;Z<Y.length;Z++)J[Z]=Y.charCodeAt(Z);return J}static async fromBlob(Y,J={}){const Z=J.name??Y.name,K=Y.type,Q=await Y.arrayBuffer();return this.fromArrayBuffer(Q,{...J,name:Z,mediaType:K})}toBlob(){if(!this.base64Content)throw new Error('File content is not available, please select property "base64Content" when querying the file');const Y=atob(this.base64Content),J=new Uint8Array(Y.length);for(let Z=0;Z<Y.length;Z++)J[Z]=Y.charCodeAt(Z);return new Blob([J],{type:this.mediaType})}static fromString(Y,J={}){const Z=btoa(Y);return new V1({...J,base64Content:Z})}toString(){if(!this.base64Content)throw new Error('File content is not available, please select property "base64Content" when querying the file');return atob(this.base64Content)}static fromBase64(Y,J={}){return new V1({...J,base64Content:Y})}toBase64(){if(!this.base64Content)throw new Error('File content is not available, please select property "base64Content" when querying the file');return this.base64Content}transform(...Y){return{url:e1(this.url,...Y),signedUrl:e1(this.signedUrl,...Y),metadataUrl:e1(this.url,...Y,{format:"json"}),metadataSignedUrl:e1(this.signedUrl,...Y,{format:"json"})}}}var iY=async(Y)=>{if(!G(Y))return null;const{id:J,name:Z,mediaType:K,base64Content:Q,enablePublicUrl:X,signedUrlTimeout:H,uploadUrlTimeout:z}=await Y;return KJ({id:J,name:Z?Z:void 0,mediaType:K,base64Content:Q,enablePublicUrl:X,signedUrlTimeout:H,uploadUrlTimeout:z})},jJ=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},Z1=(Y,J,Z)=>{return jJ(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},fJ=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},kJ=(Y,J,Z,K)=>{return jJ(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},N1,z1;class b0{constructor(Y,J,Z=[]){fJ(this,N1,void 0),kJ(this,N1,Y),this.meta=J,this.records=new d0(this,Z)}async nextPage(Y,J){return Z1(this,N1).getPaginated({pagination:{size:Y,offset:J,after:this.meta.page.cursor}})}async previousPage(Y,J){return Z1(this,N1).getPaginated({pagination:{size:Y,offset:J,before:this.meta.page.cursor}})}async startPage(Y,J){return Z1(this,N1).getPaginated({pagination:{size:Y,offset:J,start:this.meta.page.cursor}})}async endPage(Y,J){return Z1(this,N1).getPaginated({pagination:{size:Y,offset:J,end:this.meta.page.cursor}})}hasNextPage(){return this.meta.page.more}}N1=new WeakMap;var y0=1000,sY=20;var j7=class Y extends Array{constructor(...J){super(...Y.parseConstructorParams(...J));fJ(this,z1,void 0),kJ(this,z1,O(J[0]?.meta)?J[0]:{meta:{page:{cursor:"",more:!1}},records:[]})}static parseConstructorParams(...J){if(J.length===1&&typeof J[0]==="number")return new Array(J[0]);if(J.length<=2&&O(J[0]?.meta)&&Array.isArray(J[1]??[])){const Z=J[1]??J[0].records??[];return new Array(...Z)}return new Array(...J)}toArray(){return new Array(...this)}toSerializable(){return JSON.parse(this.toString())}toString(){return JSON.stringify(this.toArray())}map(J,Z){return this.toArray().map(J,Z)}async nextPage(J,Z){const K=await Z1(this,z1).nextPage(J,Z);return new Y(K)}async previousPage(J,Z){const K=await Z1(this,z1).previousPage(J,Z);return new Y(K)}async startPage(J,Z){const K=await Z1(this,z1).startPage(J,Z);return new Y(K)}async endPage(J,Z){const K=await Z1(this,z1).endPage(J,Z);return new Y(K)}hasNextPage(){return Z1(this,z1).meta.page.more}};z1=new WeakMap;var d0=j7,WY=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},q=(Y,J,Z)=>{return WY(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},Y0=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},v0=(Y,J,Z,K)=>{return WY(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},rY=(Y,J,Z)=>{return WY(Y,J,"access private method"),Z},d,u,x,Q0,c0,f7=class Y{constructor(J,Z,K,Q){if(Y0(this,Q0),Y0(this,d,void 0),Y0(this,u,void 0),Y0(this,x,{filter:{}}),this.meta={page:{cursor:"start",more:!0,size:sY}},this.records=new d0(this,[]),v0(this,d,Z),J)v0(this,u,J);else v0(this,u,this);const X=y7(K,Q);q(this,x).filter=K.filter??X?.filter??{},q(this,x).filter.$any=K.filter?.$any??X?.filter?.$any,q(this,x).filter.$all=K.filter?.$all??X?.filter?.$all,q(this,x).filter.$not=K.filter?.$not??X?.filter?.$not,q(this,x).filter.$none=K.filter?.$none??X?.filter?.$none,q(this,x).sort=K.sort??X?.sort,q(this,x).columns=K.columns??X?.columns,q(this,x).consistency=K.consistency??X?.consistency,q(this,x).pagination=K.pagination??X?.pagination,q(this,x).cache=K.cache??X?.cache,q(this,x).fetchOptions=K.fetchOptions??X?.fetchOptions,this.any=this.any.bind(this),this.all=this.all.bind(this),this.not=this.not.bind(this),this.filter=this.filter.bind(this),this.sort=this.sort.bind(this),this.none=this.none.bind(this),Object.defineProperty(this,"table",{enumerable:!1}),Object.defineProperty(this,"repository",{enumerable:!1})}getQueryOptions(){return q(this,x)}key(){const{columns:J=[],filter:Z={},sort:K=[],pagination:Q={}}=q(this,x),X=JSON.stringify({columns:J,filter:Z,sort:K,pagination:Q});return qZ(X)}any(...J){const Z=J.map((K)=>K.getQueryOptions().filter??{});return new Y(q(this,u),q(this,d),{filter:{$any:Z}},q(this,x))}all(...J){const Z=J.map((K)=>K.getQueryOptions().filter??{});return new Y(q(this,u),q(this,d),{filter:{$all:Z}},q(this,x))}not(...J){const Z=J.map((K)=>K.getQueryOptions().filter??{});return new Y(q(this,u),q(this,d),{filter:{$not:Z}},q(this,x))}none(...J){const Z=J.map((K)=>K.getQueryOptions().filter??{});return new Y(q(this,u),q(this,d),{filter:{$none:Z}},q(this,x))}filter(J,Z){if(arguments.length===1){const K=Object.entries(J??{}).map(([X,H])=>({[X]:rY(this,Q0,c0).call(this,X,H)})),Q=K1([q(this,x).filter?.$all].flat().concat(K));return new Y(q(this,u),q(this,d),{filter:{$all:Q}},q(this,x))}else{const K=G(J)&&G(Z)?[{[J]:rY(this,Q0,c0).call(this,J,Z)}]:void 0,Q=K1([q(this,x).filter?.$all].flat().concat(K));return new Y(q(this,u),q(this,d),{filter:{$all:Q}},q(this,x))}}sort(J,Z="asc"){const Q=[...[q(this,x).sort??[]].flat(),{column:J,direction:Z}];return new Y(q(this,u),q(this,d),{sort:Q},q(this,x))}select(J){return new Y(q(this,u),q(this,d),{columns:J},q(this,x))}getPaginated(J={}){const Z=new Y(q(this,u),q(this,d),J,q(this,x));return q(this,u).query(Z)}async*[Symbol.asyncIterator](){for await(let[J]of this.getIterator({batchSize:1}))yield J}async*getIterator(J={}){const{batchSize:Z=1}=J;let K=await this.getPaginated({...J,pagination:{size:Z,offset:0}}),Q=K.hasNextPage();yield K.records;while(Q)K=await K.nextPage(),Q=K.hasNextPage(),yield K.records}async getMany(J={}){const{pagination:Z={},...K}=J,{size:Q=sY,offset:X}=Z,H=Q<=y0?Q:y0;let z=await this.getPaginated({...K,pagination:{size:H,offset:X}});const V=[...z.records];while(z.hasNextPage()&&V.length<Q)z=await z.nextPage(),V.push(...z.records);if(z.hasNextPage()&&J.pagination?.size===void 0)console.trace("Calling getMany does not return all results. Paginate to get all results or call getAll.");return new d0(z,V.slice(0,Q))}async getAll(J={}){const{batchSize:Z=y0,...K}=J,Q=[];for await(let X of this.getIterator({...K,batchSize:Z}))Q.push(...X);return Q}async getFirst(J={}){return(await this.getMany({...J,pagination:{size:1}}))[0]??null}async getFirstOrThrow(J={}){const Z=await this.getMany({...J,pagination:{size:1}});if(Z[0]===void 0)throw new Error("No results found.");return Z[0]}async summarize(J={}){const{summaries:Z,summariesFilter:K,...Q}=J,X=new Y(q(this,u),q(this,d),Q,q(this,x));return q(this,u).summarizeTable(X,Z,K)}cache(J){return new Y(q(this,u),q(this,d),{cache:J},q(this,x))}nextPage(J,Z){return this.startPage(J,Z)}previousPage(J,Z){return this.startPage(J,Z)}startPage(J,Z){return this.getPaginated({pagination:{size:J,offset:Z}})}endPage(J,Z){return this.getPaginated({pagination:{size:J,offset:Z,before:"end"}})}hasNextPage(){return this.meta.page.more}};d=new WeakMap;u=new WeakMap;x=new WeakMap;Q0=new WeakSet;c0=function(Y,J){const Z=q(this,d).schema?.columns.find(({name:K})=>K===Y)?.type;if(Z==="multiple"&&(A(J)||QJ(J)))return{$includes:J};if(Z==="link"&&O(J)&&A(J.id))return J.id;return J};var k7=f7;var NY=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},L=(Y,J,Z)=>{return NY(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},g=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},U1=(Y,J,Z,K)=>{return NY(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},w=(Y,J,Z)=>{return NY(Y,J,"access private method"),Z},R,k,o,T1,G1,m,l0,vJ,w1,u1,X0,n0,H0,o0,z0,i0,V0,s0,W0,r0,t0,gJ,a0,hJ,e0,_J,i,r,L1,P1,UY=1000;class YY extends k7{constructor(Y){super(null,{name:Y.table,schema:Y.schemaTables?.find((Z)=>Z.name===Y.table)},{});g(this,l0),g(this,w1),g(this,X0),g(this,H0),g(this,z0),g(this,V0),g(this,W0),g(this,t0),g(this,a0),g(this,e0),g(this,i),g(this,L1),g(this,R,void 0),g(this,k,void 0),g(this,o,void 0),g(this,T1,void 0),g(this,G1,void 0),g(this,m,void 0),U1(this,R,Y.table),U1(this,o,Y.db),U1(this,T1,Y.pluginOptions.cache),U1(this,G1,Y.schemaTables),U1(this,k,()=>({...Y.pluginOptions,sessionID:b1()}));const J=Y.pluginOptions.trace??JJ;U1(this,m,async(Z,K,Q={})=>{return J(Z,K,{...Q,[n.TABLE]:L(this,R),[n.KIND]:"sdk-operation",[n.VERSION]:zY})})}async create(Y,J,Z,K){return L(this,m).call(this,"create",async()=>{const Q=A1(J,Z,K);if(Array.isArray(Y)){if(Y.length===0)return[];const X=await w(this,X0,n0).call(this,Y,{ifVersion:Q,createOnly:!0}),H=b(J)?J:["*"];return await this.read(X,H)}if(A(Y)&&O(J)){if(Y==="")throw new Error("The id can't be empty");const X=b(Z)?Z:void 0;return await w(this,w1,u1).call(this,Y,J,X,{createOnly:!0,ifVersion:Q})}if(O(Y)&&A(Y.id)){if(Y.id==="")throw new Error("The id can't be empty");const X=b(J)?J:void 0;return await w(this,w1,u1).call(this,Y.id,{...Y,id:void 0},X,{createOnly:!0,ifVersion:Q})}if(O(Y)){const X=b(J)?J:void 0;return w(this,l0,vJ).call(this,Y,X)}throw new Error("Invalid arguments for create method")})}async read(Y,J){return L(this,m).call(this,"read",async()=>{const Z=b(J)?J:["*"];if(Array.isArray(Y)){if(Y.length===0)return[];const Q=Y.map((z)=>H1(z)),H=(await this.getAll({filter:{id:{$any:K1(Q)}},columns:Z})).reduce((z,V)=>{return z[V.id]=V,z},{});return Q.map((z)=>H[z??""]??null)}const K=H1(Y);if(K)try{const Q=await BJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R),recordId:K},queryParams:{columns:Z},...L(this,k).call(this)}),X=await w(this,i,r).call(this);return s(L(this,o),X,L(this,R),Q,Z)}catch(Q){if(O(Q)&&Q.status===404)return null;throw Q}return null})}async readOrThrow(Y,J){return L(this,m).call(this,"readOrThrow",async()=>{const Z=await this.read(Y,J);if(Array.isArray(Z)){const K=K1(Y.filter((Q,X)=>Z[X]===null).map((Q)=>H1(Q)));if(K.length>0)throw new Error(`Could not find records with ids: ${K.join(", ")}`);return Z}if(Z===null){const K=H1(Y)??"unknown";throw new Error(`Record with id ${K} not found`)}return Z})}async update(Y,J,Z,K){return L(this,m).call(this,"update",async()=>{const Q=A1(J,Z,K);if(Array.isArray(Y)){if(Y.length===0)return[];const X=await this.read(Y,["id"]),H=Y.filter((W,U)=>X[U]!==null);await w(this,z0,i0).call(this,H,{ifVersion:Q,upsert:!1});const z=b(J)?J:["*"];return await this.read(Y,z)}try{if(A(Y)&&O(J)){const X=b(Z)?Z:void 0;return await w(this,H0,o0).call(this,Y,J,X,{ifVersion:Q})}if(O(Y)&&A(Y.id)){const X=b(J)?J:void 0;return await w(this,H0,o0).call(this,Y.id,{...Y,id:void 0},X,{ifVersion:Q})}}catch(X){if(X.status===422)return null;throw X}throw new Error("Invalid arguments for update method")})}async updateOrThrow(Y,J,Z,K){return L(this,m).call(this,"updateOrThrow",async()=>{const Q=await this.update(Y,J,Z,K);if(Array.isArray(Q)){const X=K1(Y.filter((H,z)=>Q[z]===null).map((H)=>H1(H)));if(X.length>0)throw new Error(`Could not find records with ids: ${X.join(", ")}`);return Q}if(Q===null){const X=H1(Y)??"unknown";throw new Error(`Record with id ${X} not found`)}return Q})}async createOrUpdate(Y,J,Z,K){return L(this,m).call(this,"createOrUpdate",async()=>{const Q=A1(J,Z,K);if(Array.isArray(Y)){if(Y.length===0)return[];await w(this,z0,i0).call(this,Y,{ifVersion:Q,upsert:!0});const X=b(J)?J:["*"];return await this.read(Y,X)}if(A(Y)&&O(J)){if(Y==="")throw new Error("The id can't be empty");const X=b(Z)?Z:void 0;return await w(this,V0,s0).call(this,Y,J,X,{ifVersion:Q})}if(O(Y)&&A(Y.id)){if(Y.id==="")throw new Error("The id can't be empty");const X=b(Z)?Z:void 0;return await w(this,V0,s0).call(this,Y.id,{...Y,id:void 0},X,{ifVersion:Q})}if(!G(Y)&&O(J))return await this.create(J,Z);if(O(Y)&&!G(Y.id))return await this.create(Y,J);throw new Error("Invalid arguments for createOrUpdate method")})}async createOrReplace(Y,J,Z,K){return L(this,m).call(this,"createOrReplace",async()=>{const Q=A1(J,Z,K);if(Array.isArray(Y)){if(Y.length===0)return[];const X=await w(this,X0,n0).call(this,Y,{ifVersion:Q,createOnly:!1}),H=b(J)?J:["*"];return await this.read(X,H)}if(A(Y)&&O(J)){if(Y==="")throw new Error("The id can't be empty");const X=b(Z)?Z:void 0;return await w(this,w1,u1).call(this,Y,J,X,{createOnly:!1,ifVersion:Q})}if(O(Y)&&A(Y.id)){if(Y.id==="")throw new Error("The id can't be empty");const X=b(Z)?Z:void 0;return await w(this,w1,u1).call(this,Y.id,{...Y,id:void 0},X,{createOnly:!1,ifVersion:Q})}if(!G(Y)&&O(J))return await this.create(J,Z);if(O(Y)&&!G(Y.id))return await this.create(Y,J);throw new Error("Invalid arguments for createOrReplace method")})}async delete(Y,J){return L(this,m).call(this,"delete",async()=>{if(Array.isArray(Y)){if(Y.length===0)return[];const Z=Y.map((X)=>{if(A(X))return X;if(A(X.id))return X.id;throw new Error("Invalid arguments for delete method")}),K=b(J)?J:["*"],Q=await this.read(Y,K);return await w(this,t0,gJ).call(this,Z),Q}if(A(Y))return w(this,W0,r0).call(this,Y,J);if(O(Y)&&A(Y.id))return w(this,W0,r0).call(this,Y.id,J);throw new Error("Invalid arguments for delete method")})}async deleteOrThrow(Y,J){return L(this,m).call(this,"deleteOrThrow",async()=>{const Z=await this.delete(Y,J);if(Array.isArray(Z)){const K=K1(Y.filter((Q,X)=>Z[X]===null).map((Q)=>H1(Q)));if(K.length>0)throw new Error(`Could not find records with ids: ${K.join(", ")}`);return Z}else if(Z===null){const K=H1(Y)??"unknown";throw new Error(`Record with id ${K} not found`)}return Z})}async search(Y,J={}){return L(this,m).call(this,"search",async()=>{const{records:Z,totalCount:K}=await xJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R)},body:{query:Y,fuzziness:J.fuzziness,prefix:J.prefix,highlight:J.highlight,filter:J.filter,boosters:J.boosters,page:J.page,target:J.target},...L(this,k).call(this)}),Q=await w(this,i,r).call(this);return{records:Z.map((X)=>s(L(this,o),Q,L(this,R),X,["*"])),totalCount:K}})}async vectorSearch(Y,J,Z){return L(this,m).call(this,"vectorSearch",async()=>{const{records:K,totalCount:Q}=await GJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R)},body:{column:Y,queryVector:J,similarityFunction:Z?.similarityFunction,size:Z?.size,filter:Z?.filter},...L(this,k).call(this)}),X=await w(this,i,r).call(this);return{records:K.map((H)=>s(L(this,o),X,L(this,R),H,["*"])),totalCount:Q}})}async aggregate(Y,J){return L(this,m).call(this,"aggregate",async()=>{return await $J({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R)},body:{aggs:Y,filter:J},...L(this,k).call(this)})})}async query(Y){return L(this,m).call(this,"query",async()=>{const J=await w(this,e0,_J).call(this,Y);if(J)return new b0(Y,J.meta,J.records);const Z=Y.getQueryOptions(),{meta:K,records:Q}=await RJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R)},body:{filter:M0(Z.filter),sort:Z.sort!==void 0?p0(Z.sort):void 0,page:Z.pagination,columns:Z.columns??["*"],consistency:Z.consistency},fetchOptions:Z.fetchOptions,...L(this,k).call(this)}),X=await w(this,i,r).call(this),H=Q.map((z)=>s(L(this,o),X,L(this,R),z,Z.columns??["*"]));return await w(this,a0,hJ).call(this,Y,K,H),new b0(Y,K,H)})}async summarizeTable(Y,J,Z){return L(this,m).call(this,"summarize",async()=>{const K=Y.getQueryOptions(),Q=await TJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R)},body:{filter:M0(K.filter),sort:K.sort!==void 0?p0(K.sort):void 0,columns:K.columns,consistency:K.consistency,page:K.pagination?.size!==void 0?{size:K.pagination?.size}:void 0,summaries:J,summariesFilter:Z},...L(this,k).call(this)}),X=await w(this,i,r).call(this);return{...Q,summaries:Q.summaries.map((H)=>s(L(this,o),X,L(this,R),H,K.columns??[]))}})}ask(Y,J){const Z=J?.sessionId?{message:Y}:{question:Y},K={pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R),sessionId:J?.sessionId},body:{...Z,rules:J?.rules,searchType:J?.searchType,search:J?.searchType==="keyword"?J?.search:void 0,vectorSearch:J?.searchType==="vector"?J?.vectorSearch:void 0},...L(this,k).call(this)};if(J?.onMessage)uZ({endpoint:"dataPlane",url:"/db/{dbBranchName}/tables/{tableName}/ask/{sessionId}",method:"POST",onMessage:(Q)=>{J.onMessage?.({answer:Q.text,records:Q.records})},...K});else return SJ(K)}}R=new WeakMap;k=new WeakMap;o=new WeakMap;T1=new WeakMap;G1=new WeakMap;m=new WeakMap;l0=new WeakSet;vJ=async function(Y,J=["*"]){const Z=await w(this,L1,P1).call(this,Y),K=await MJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R)},queryParams:{columns:J},body:Z,...L(this,k).call(this)}),Q=await w(this,i,r).call(this);return s(L(this,o),Q,L(this,R),K,J)};w1=new WeakSet;u1=async function(Y,J,Z=["*"],{createOnly:K,ifVersion:Q}){if(!Y)return null;const X=await w(this,L1,P1).call(this,J),H=await CJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R),recordId:Y},body:X,queryParams:{createOnly:K,columns:Z,ifVersion:Q},...L(this,k).call(this)}),z=await w(this,i,r).call(this);return s(L(this,o),z,L(this,R),H,Z)};X0=new WeakSet;n0=async function(Y,{createOnly:J,ifVersion:Z}){const K=await XY(Y,async(H)=>{const z=await w(this,L1,P1).call(this,H);return{insert:{table:L(this,R),record:z,createOnly:J,ifVersion:Z}}}),Q=QY(K,UY),X=[];for(let H of Q){const{results:z}=await d1({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{operations:H},...L(this,k).call(this)});for(let V of z)if(V.operation==="insert")X.push(V.id);else X.push(null)}return X};H0=new WeakSet;o0=async function(Y,J,Z=["*"],{ifVersion:K}){if(!Y)return null;const{id:Q,...X}=await w(this,L1,P1).call(this,J);try{const H=await FJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R),recordId:Y},queryParams:{columns:Z,ifVersion:K},body:X,...L(this,k).call(this)}),z=await w(this,i,r).call(this);return s(L(this,o),z,L(this,R),H,Z)}catch(H){if(O(H)&&H.status===404)return null;throw H}};z0=new WeakSet;i0=async function(Y,{ifVersion:J,upsert:Z}){const K=await XY(Y,async({id:H,...z})=>{const V=await w(this,L1,P1).call(this,z);return{update:{table:L(this,R),id:H,ifVersion:J,upsert:Z,fields:V}}}),Q=QY(K,UY),X=[];for(let H of Q){const{results:z}=await d1({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{operations:H},...L(this,k).call(this)});for(let V of z)if(V.operation==="update")X.push(V.id);else X.push(null)}return X};V0=new WeakSet;s0=async function(Y,J,Z=["*"],{ifVersion:K}){if(!Y)return null;const Q=await wJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R),recordId:Y},queryParams:{columns:Z,ifVersion:K},body:J,...L(this,k).call(this)}),X=await w(this,i,r).call(this);return s(L(this,o),X,L(this,R),Q,Z)};W0=new WeakSet;r0=async function(Y,J=["*"]){if(!Y)return null;try{const Z=await IJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:L(this,R),recordId:Y},queryParams:{columns:J},...L(this,k).call(this)}),K=await w(this,i,r).call(this);return s(L(this,o),K,L(this,R),Z,J)}catch(Z){if(O(Z)&&Z.status===404)return null;throw Z}};t0=new WeakSet;gJ=async function(Y){const J=QY(K1(Y).map((Z)=>({delete:{table:L(this,R),id:Z}})),UY);for(let Z of J)await d1({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{operations:Z},...L(this,k).call(this)})};a0=new WeakSet;hJ=async function(Y,J,Z){await L(this,T1)?.set(`query_${L(this,R)}:${Y.key()}`,{date:new Date,meta:J,records:Z})};e0=new WeakSet;_J=async function(Y){const J=`query_${L(this,R)}:${Y.key()}`,Z=await L(this,T1)?.get(J);if(!Z)return null;const K=L(this,T1)?.defaultQueryTTL??-1,{cache:Q=K}=Y.getQueryOptions();if(Q<0)return null;return Z.date.getTime()+Q<Date.now()?null:Z};i=new WeakSet;r=async function(){if(L(this,G1))return L(this,G1);const{schema:Y}=await VY({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},...L(this,k).call(this)});return U1(this,G1,Y.tables),Y.tables};L1=new WeakSet;P1=async function(Y){const Z=(await w(this,i,r).call(this)).find((Q)=>Q.name===L(this,R));if(!Z)throw new Error(`Table ${L(this,R)} not found in schema`);const K={};for(let[Q,X]of Object.entries(Y)){if(Q==="xata")continue;switch(Z.columns.find((z)=>z.name===Q)?.type){case"link":{K[Q]=v7(X)?X.id:X;break}case"datetime":{K[Q]=X instanceof Date?X.toISOString():X;break}case"file":K[Q]=await iY(X);break;case"file[]":K[Q]=await XY(X,(z)=>iY(z));break;case"json":K[Q]=T7(X);break;default:K[Q]=X}}return K};var s=(Y,J,Z,K,Q)=>{const X={},{xata:H,...z}=K??{};Object.assign(X,z);const{columns:V}=J.find(({name:N})=>N===Z)??{};if(!V)console.error(`Table ${Z} not found in schema`);for(let N of V??[]){if(!u7(Q,N))continue;const M=X[N.name];switch(N.type){case"datetime":{const B=M!==void 0?new Date(M):null;if(B!==null&&isNaN(B.getTime()))console.error(`Failed to parse date ${M} for field ${N.name}`);else X[N.name]=B;break}case"link":{const B=N.link?.table;if(!B)console.error(`Failed to parse link for field ${N.name}`);else if(O(M)){const S=Q.reduce((C,I)=>{if(I===N.name)return[...C,"*"];if(A(I)&&I.startsWith(`${N.name}.`)){const[,...T]=I.split(".");return[...C,T.join(".")]}return C},[]);X[N.name]=s(Y,J,B,M,S)}else X[N.name]=null;break}case"file":X[N.name]=G(M)?new V1(M):null;break;case"file[]":X[N.name]=M?.map((B)=>new V1(B))??null;break;case"json":X[N.name]=$7(M);break;default:if(X[N.name]=M??null,N.notNull===!0&&M===null)console.error(`Parse error, column ${N.name} is non nullable and value resolves null`);break}}const W={...X},U=H!==void 0?{...H,createdAt:new Date(H.createdAt),updatedAt:new Date(H.updatedAt)}:void 0;if(W.read=function(N){return Y[Z].read(W.id,N)},W.update=function(N,M,B){const S=b(M)?M:["*"],C=A1(M,B);return Y[Z].update(W.id,N,S,{ifVersion:C})},W.replace=function(N,M,B){const S=b(M)?M:["*"],C=A1(M,B);return Y[Z].createOrReplace(W.id,N,S,{ifVersion:C})},W.delete=function(){return Y[Z].delete(W.id)},U!==void 0)W.xata=Object.freeze(U);W.getMetadata=function(){return W.xata},W.toSerializable=function(){return JSON.parse(JSON.stringify(W))},W.toString=function(){return JSON.stringify(W)};for(let N of["read","update","replace","delete","getMetadata","toSerializable","toString"])Object.defineProperty(W,N,{enumerable:!1});return Object.freeze(W),W},uJ=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},W1=(Y,J,Z)=>{return uJ(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},m7=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},b7=(Y,J,Z,K)=>{return uJ(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},e;class mJ{constructor(Y={}){m7(this,e,void 0),b7(this,e,new Map),this.capacity=Y.max??500,this.defaultQueryTTL=Y.defaultQueryTTL??60000}async getAll(){return Object.fromEntries(W1(this,e))}async get(Y){return W1(this,e).get(Y)??null}async set(Y,J){if(await this.delete(Y),W1(this,e).set(Y,J),W1(this,e).size>this.capacity){const Z=W1(this,e).keys().next().value;await this.delete(Z)}}async delete(Y){W1(this,e).delete(Y)}async clear(){return W1(this,e).clear()}}e=new WeakMap;var bJ=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},F1=(Y,J,Z)=>{return bJ(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},tY=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},d7=(Y,J,Z,K)=>{return bJ(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},m1,I1;class dJ extends $1{constructor(Y){super();tY(this,m1,{}),tY(this,I1,void 0),d7(this,I1,Y)}build(Y){const J=new Proxy({},{get:(K,Q)=>{if(!A(Q))throw new Error("Invalid table name");if(F1(this,m1)[Q]===void 0)F1(this,m1)[Q]=new YY({db:J,pluginOptions:Y,table:Q,schemaTables:F1(this,I1)});return F1(this,m1)[Q]}}),Z=F1(this,I1)?.map(({name:K})=>K)??[];for(let K of Z)J[K]=new YY({db:J,pluginOptions:Y,table:K,schemaTables:F1(this,I1)});return J}}m1=new WeakMap;I1=new WeakMap;class cJ extends $1{build(Y){return{download:async(J)=>{const{table:Z,record:K,column:Q,fileId:X=""}=J??{};return await qJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:Z??"",recordId:K??"",columnName:Q??"",fileId:X},...Y,rawResponse:!0})},upload:async(J,Z,K)=>{const{table:Q,record:X,column:H,fileId:z=""}=J??{},V=await Z,W=K?.mediaType||c7(V),U=V instanceof V1?V.toBlob():V;return await EJ({...Y,pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:Q??"",recordId:X??"",columnName:H??"",fileId:z},body:U,headers:{"Content-Type":W}})},delete:async(J)=>{const{table:Z,record:K,column:Q,fileId:X=""}=J??{};return await OJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:Z??"",recordId:K??"",columnName:Q??"",fileId:X},...Y})}}}}var LY=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},aY=(Y,J,Z)=>{return LY(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},g0=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},pJ=(Y,J,Z,K)=>{return LY(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},J0=(Y,J,Z)=>{return LY(Y,J,"access private method"),Z},S1,N0,JY,U0,ZY;class lJ extends $1{constructor(Y,J){super();this.db=Y,g0(this,N0),g0(this,U0),g0(this,S1,void 0),pJ(this,S1,J)}build(Y){return{all:async(J,Z={})=>{const{records:K,totalCount:Q}=await J0(this,N0,JY).call(this,J,Z,Y),X=await J0(this,U0,ZY).call(this,Y);return{totalCount:Q,records:K.map((H)=>{const{table:z="orphan"}=H.xata;return{table:z,record:s(this.db,X,z,H,["*"])}})}},byTable:async(J,Z={})=>{const{records:K,totalCount:Q}=await J0(this,N0,JY).call(this,J,Z,Y),X=await J0(this,U0,ZY).call(this,Y),H=K.reduce((z,V)=>{const{table:W="orphan"}=V.xata,U=z[W]??[],N=s(this.db,X,W,V,["*"]);return{...z,[W]:[...U,N]}},{});return{totalCount:Q,records:H}}}}}S1=new WeakMap;N0=new WeakSet;JY=async function(Y,J,Z){const{tables:K,fuzziness:Q,highlight:X,prefix:H,page:z}=J??{},{records:V,totalCount:W}=await AJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{tables:K,query:Y,fuzziness:Q,prefix:H,highlight:X,page:z},...Z});return{records:V,totalCount:W}};U0=new WeakSet;ZY=async function(Y){if(aY(this,S1))return aY(this,S1);const{schema:J}=await VY({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},...Y});return pJ(this,S1,J.tables),J.tables};class oJ extends $1{build(Y){return async(J,...Z)=>{const{statement:K,params:Q,consistency:X}=l7(J,Z),{records:H,warning:z}=await PJ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{statement:K,params:Q,consistency:X},...Y});return{records:H,warning:z}}}}class iJ extends $1{build(Y){return{run:async(J)=>{return await d1({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{operations:J},...Y})}}}}var DY=(Y,J,Z)=>{if(!J.has(Y))throw TypeError("Cannot "+Z)},eY=(Y,J,Z)=>{return DY(Y,J,"read from private field"),Z?Z.call(Y):J.get(Y)},h0=(Y,J,Z)=>{if(J.has(Y))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(Y):J.set(Y,Z)},n7=(Y,J,Z,K)=>{return DY(Y,J,"write to private field"),K?K.call(Y,Z):J.set(Y,Z),Z},YJ=(Y,J,Z)=>{return DY(Y,J,"access private method"),Z},MY=(Y)=>{var J,Z,K,Q,X,H;return H=class{constructor(z={},V){h0(this,Z),h0(this,Q),h0(this,J,void 0);const W=YJ(this,Z,K).call(this,z);n7(this,J,W);const U={...YJ(this,Q,X).call(this,W),cache:W.cache,host:W.host},N=new dJ(V).build(U),M=new lJ(N,V).build(U),B=new iJ().build(U),S=new oJ().build(U),C=new cJ().build(U);this.db=N,this.search=M,this.transactions=B,this.sql=S,this.files=C;for(let[I,T]of Object.entries(Y??{})){if(T===void 0)continue;this[I]=T.build(U)}}async getConfig(){const z=eY(this,J).databaseURL,V=eY(this,J).branch;return{databaseURL:z,branch:V}}},J=new WeakMap,Z=new WeakSet,K=function(z){const V=z?.enableBrowser??BZ()??!1;if(typeof window!=="undefined"&&typeof Deno==="undefined"&&!V)throw new Error("You are trying to use Xata from the browser, which is potentially a non-secure environment. If you understand the security concerns, such as leaking your credentials, pass `enableBrowser: true` to the client options to remove this error.");const U=GZ(z?.fetch),N=z?.databaseURL||CZ(),M=z?.apiKey||FZ(),B=z?.cache??new mJ({defaultQueryTTL:0}),S=z?.trace??JJ,C=z?.clientName,I=z?.host??"production",T=z?.xataAgentExtra;if(!M)throw new Error("Option apiKey is required");if(!N)throw new Error("Option databaseURL is required");const $=wZ(),y=RZ(),v=z?.branch||y||$||"main";if(!!y&&v!==y)console.warn(`Ignoring preview branch ${y} because branch option was passed to the client constructor with value ${v}`);else if(!!$&&v!==$)console.warn(`Ignoring branch ${$} because branch option was passed to the client constructor with value ${v}`);else if(!!y&&!!$&&y!==$)console.warn(`Ignoring preview branch ${y} and branch ${$} because branch option was passed to the client constructor with value ${v}`);else if(!y&&!$&&z?.branch===void 0)console.warn(`No branch was passed to the client constructor. Using default branch ${v}. You can set the branch with the environment variable XATA_BRANCH or by passing the branch option to the client constructor.`);return{fetch:U,databaseURL:N,apiKey:M,branch:v,cache:B,trace:S,host:I,clientID:b1(),enableBrowser:V,clientName:C,xataAgentExtra:T}},Q=new WeakSet,X=function({fetch:z,apiKey:V,databaseURL:W,branch:U,trace:N,clientID:M,clientName:B,xataAgentExtra:S}){return{fetch:z,apiKey:V,apiUrl:"",workspacesApiUrl:(C,I)=>{const T=I.dbBranchName??I.branch,$=C.replace(/^\/db\/[^/]+/,T!==void 0?`:${U}`:"");return W+$},trace:N,clientID:M,clientName:B,xataAgentExtra:S}},H};class o7 extends MY(){}var Z0="__",h1="___";class sJ{constructor(){this.classes={}}add(Y){this.classes[Y.name]=Y}toJSON(Y){function J(Z){if(Array.isArray(Z))return Z.map(J);const K=typeof Z;if(K==="undefined")return{[Z0]:"undefined"};if(K==="bigint")return{[Z0]:"bigint",[h1]:Z.toString()};if(Z===null||K!=="object")return Z;const Q=Z.constructor,X={[Z0]:Q.name};for(let[H,z]of Object.entries(Z))X[H]=J(z);if(Q===Date)X[h1]=Z.toISOString();if(Q===Map)X[h1]=Object.fromEntries(Z);if(Q===Set)X[h1]=[...Z];return X}return JSON.stringify(J(Y))}fromJSON(Y){return JSON.parse(Y,(J,Z)=>{if(Z&&typeof Z==="object"&&!Array.isArray(Z)){const{[Z0]:K,[h1]:Q,...X}=Z,H=this.classes[K];if(H)return Object.assign(Object.create(H.prototype),X);if(K==="Date")return new Date(Q);if(K==="Set")return new Set(Q);if(K==="Map")return new Map(Object.entries(Q));if(K==="bigint")return BigInt(Q);if(K==="undefined")return;return X}return Z})}}var FK=new sJ;var i7=[{name:"user",columns:[{name:"firstname",type:"text"},{name:"lastname",type:"text"},{name:"password",type:"string"},{name:"email",type:"email",unique:!0},{name:"username",type:"string",unique:!0}]}],s7=MY(),r7={databaseURL:"https://steam-learn-db-q51rvp.eu-west-1.xata.sh/db/steamlearndb"};class rJ extends s7{constructor(Y){super({...r7,...Y},i7)}}var E0=void 0,tJ=()=>{if(E0)return E0;return E0=new rJ,E0};var qY=new g1,t7=tJ(),aJ=t7.db.user.getAll();console.log(aJ);qY.get("/",async(Y)=>Y.json(await aJ));qY.get("/:id",(Y)=>Y.json(`get ${Y.req.param("id")}`));var eJ=qY;var O0=new g1().basePath("/api");O0.use("*",cY());var jK=O0.route("/users",eJ);console.log(O0.all);var fK={port:3000,fetch:O0.fetch};export{fK as default};

//# debugId=706A686246B9E15864756e2164756e21
